(function(){"use strict";var e={6623:function(e,t,n){var a=n(3864);const o={class:"row"},r={class:"col"},i={class:"modal custom-modal",id:"processingModal",ref:"processingModal",style:{display:"none"}},l={class:"modal-dialog modal-dialog-centered custom-modal-container"},s={class:"modal-content fs-1 text-center custom-modal-content"},d={class:"p-3 modal-message"},c=(0,a.Lk)("div",{class:"dot-floating"},null,-1),u={class:"default-modal",id:"infoModal",ref:"infoModal",style:{display:"none"}},p={class:"modal-body d-flex flex-row align-items-center pt-5"},f=(0,a.Lk)("div",{class:"ps-2 pe-3 color-blue"},[(0,a.Lk)("i",{class:"bi bi-info-circle-fill fs-1"})],-1),h={class:"modal-footer"},m={class:"default-modal",id:"statusModal",ref:"statusModal",style:{display:"none"}},b={class:"modal-body d-flex flex-row align-items-center pt-5"},g=(0,a.Lk)("div",{class:"ps-2 pe-3 color-blue"},[(0,a.Lk)("i",{class:"bi bi-info-circle-fill fs-1"})],-1),k={id:"statusModalMsg",ref:"statusModalMsg"},y={class:"modal-footer"},v={class:"modal-backdrop",ref:"modalBackdrop",style:{display:"none"}};function L(e,t,n,L,x,w){const S=(0,a.g2)("FileUploader");return(0,a.uX)(),(0,a.CE)(a.FK,null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(x.parsedUploadConfig,((e,t)=>((0,a.uX)(),(0,a.Wv)(S,{key:t,"component-id":t,"expects-zip":"zip file"===e.upload_type,name:e.name,blueprints:e.blueprints,instructions:e.instructions,"exception-url":this.exceptionUrl,"combined-consent":e.combined_consent,onChangedData:w.updatePostData},null,8,["component-id","expects-zip","name","blueprints","instructions","exception-url","combined-consent","onChangedData"])))),128)),(0,a.Lk)("div",o,[(0,a.Lk)("div",r,[(0,a.Lk)("button",{class:"flow-btn",type:"button",onClick:t[0]||(t[0]=e=>w.processData(!1))},(0,a.v_)(e.$t("next-btn-label"))+"  ›",1)])]),(0,a.Lk)("div",i,[(0,a.Lk)("div",l,[(0,a.Lk)("div",s,[(0,a.Lk)("div",d,(0,a.v_)(e.$t("data-submit-wait")),1),c])])],512),(0,a.Lk)("div",u,[(0,a.Lk)("div",p,[f,(0,a.Lk)("div",null,(0,a.v_)(this.infoModalMsg),1)]),(0,a.Lk)("div",h,[(0,a.Lk)("button",{class:"ddm-btn",type:"button",id:"closeInfoModal",onClick:t[1]||(t[1]=(...e)=>w.closeInfoModal&&w.closeInfoModal(...e))},"OK")])],512),(0,a.Lk)("div",m,[(0,a.Lk)("div",b,[g,(0,a.Lk)("div",k,null,512)]),(0,a.Lk)("div",y,[(0,a.Lk)("button",{class:"ddm-btn",type:"button",id:"cancelStatusModal",onClick:t[2]||(t[2]=(...e)=>w.closeStatusModal&&w.closeStatusModal(...e))},(0,a.v_)(e.$t("cancel-label")),1),(0,a.Lk)("button",{class:"ddm-btn",type:"button",id:"closeStatusModal",onClick:t[3]||(t[3]=e=>w.processData(!0))},(0,a.v_)(e.$t("continue-anyway-label")),1)])],512),(0,a.Lk)("div",v,null,512)],64)}n(4114),n(8992),n(3949);const x=e=>((0,a.Qi)("data-v-8fc45dd0"),e=e(),(0,a.jt)(),e),w={class:"mb-5"},S={class:"float-left bg-dark text-white pt-2 ps-2 pb-1 rounded-top"},_={class:"col-sm"},D=["id"],z={class:"accordion-body border"},E={class:"row align-items-center"},$=x((()=>(0,a.Lk)("div",{class:"col-auto ul-status-icon"},[(0,a.Lk)("i",{class:"bi bi-signpost"})],-1))),C={class:"col-auto"},I=["id"],M=["data-bs-target","aria-controls"],F=["id","data-bs-parent"],T={class:"accordion-body ps-0 pe-0"},X={class:"accordion-body border"},O={class:"row align-items-center"},U=x((()=>(0,a.Lk)("div",{class:"col-auto ul-status-icon"},[(0,a.Lk)("i",{class:"bi bi-upload"})],-1))),j={class:"col-auto ul-status-description"},P={key:0},A={key:1},N={class:"col ul-status-message"},K={class:"select-file-btn"},B=["name"],V=x((()=>(0,a.Lk)("div",{class:"col-auto ul-status-icon"},[(0,a.Lk)("div",{class:"clearfix"},[(0,a.Lk)("p",null,[(0,a.Lk)("span",{class:"spinner-border float-right me-3",role:"status"},[(0,a.Lk)("span",{class:"sr-only"})])])])],-1))),R={class:"col ul-status-description"},Q=x((()=>(0,a.Lk)("div",{class:"col ul-status-message"},null,-1))),H=x((()=>(0,a.Lk)("div",{class:"col-auto ul-status-icon"},[(0,a.Lk)("i",{class:"bi bi-file-check"})],-1))),q={class:"col ul-status-description"},W={class:"text-success fw-bold"},Z=x((()=>(0,a.Lk)("div",{class:"col ul-status-message"},null,-1))),J=x((()=>(0,a.Lk)("div",{class:"col-auto ul-status-icon"},[(0,a.Lk)("i",{class:"bi bi-exclamation-diamond text-orange"})],-1))),Y={class:"col-auto ul-status-description"},G={class:"fw-bold"},ee={class:"col ul-status-message"},te=x((()=>(0,a.Lk)("div",{class:"col-auto ul-status-icon"},[(0,a.Lk)("i",{class:"bi bi-x-octagon text-danger"})],-1))),ne={class:"col-auto ul-status-description"},ae={class:"fw-bold"},oe={class:"col ul-status-message"},re={class:"text-danger"},ie={class:"accordion-body border border-bottom-0"},le={class:"row align-items-center"},se=x((()=>(0,a.Lk)("div",{class:"col-auto ul-status-icon"},[(0,a.Lk)("i",{class:"bi bi-clipboard-data"})],-1))),de={class:"col extraction-information-container"},ce={class:"col"},ue={class:"col"},pe={class:"accordion-body border border-top-0"},fe={class:"container ul-feedback-container"},he={class:"row"},me={class:"col extraction-information-container"},be=x((()=>(0,a.Lk)("div",{class:"col w-small bp-ul-icon"},[(0,a.Lk)("i",{class:"bi bi-file-earmark-fill text-grey"})],-1))),ge={class:"col"},ke={class:"col bp-description pb-2"},ye={class:"col bp-ul-status"},ve={class:"row pb-2"},Le=x((()=>(0,a.Lk)("div",{class:"col w-small bp-ul-icon"},[(0,a.Lk)("i",{class:"bi bi-file-earmark-check-fill text-success"})],-1))),xe={class:"col"},we={class:"col bp-description pb-2"},Se={class:"col bp-ul-status"},_e={class:"row pt-2"},De={class:"col feedback-col"},ze={class:"data-donation-container pb-3 pt-3 fs-09"},Ee=["id"],$e={class:"data-donation-table"},Ce=["id"],Ie={key:1},Me={class:"data-table-navigation"},Fe={class:"pb-2"},Te=["onClick"],Xe={key:1,class:"btn-secondary btn-sm me-2 btn-light text-muted user-select-none btn-muted"},Oe=["onClick"],Ue={key:3,class:"btn-secondary btn-sm btn-light text-muted user-select-none btn-muted"},je={class:"pb-3"},Pe={class:"pb-3"},Ae=x((()=>(0,a.Lk)("div",null,null,-1))),Ne=["id"],Ke=["id","onClick"],Be=["id"],Ve={key:0,class:"row"},Re={class:"col feedback-col pb-5 pt-1"},Qe={class:"fw-bold"},He={class:"consent-question-container"},qe={class:"question-choice-item pt-3 pt-lg-0"},We=["for"],Ze=["id","name","onUpdate:modelValue"],Je={class:"question-choice-item pt-3 pt-lg-0"},Ye=["for"],Ge=["id","name","onUpdate:modelValue"],et=x((()=>(0,a.Lk)("div",{class:"col w-small bp-ul-icon"},[(0,a.Lk)("i",{class:"bi bi-file-earmark-x-fill text-grey"})],-1))),tt={class:"col-4 bp-description"},nt={class:"col bp-ul-status"},at={key:1},ot=x((()=>(0,a.Lk)("div",{class:"col-auto bp-ul-data"},null,-1))),rt=x((()=>(0,a.Lk)("div",{class:"col-auto bp-ul-consent"},null,-1))),it=x((()=>(0,a.Lk)("div",{class:"col w-small bp-ul-icon"},[(0,a.Lk)("i",{class:"bi bi-file-earmark-x-fill text-danger"})],-1))),lt={class:"col-4 bp-description"},st={class:"col bp-ul-status"},dt={key:1},ct=x((()=>(0,a.Lk)("div",{class:"col-auto bp-ul-data"},null,-1))),ut=x((()=>(0,a.Lk)("div",{class:"col-auto bp-ul-consent"},null,-1))),pt={key:0,class:"row mt-5"},ft={class:"col feedback-col pb-5 pt-1"},ht={class:"fw-bold"},mt={class:"consent-question-container"},bt={class:"question-choice-item pt-3 pt-lg-0"},gt={class:"form-check-label rb-cb-label",for:"combined-donate-agree"},kt={class:"question-choice-item pt-3 pt-lg-0"},yt={class:"form-check-label rb-cb-label",for:"combined-donate-disagree"},vt={class:"default-modal",id:"ulInfoModal",ref:"ulInfoModal",style:{display:"none"}},Lt={class:"modal-body d-flex flex-row align-items-center pt-5"},xt=x((()=>(0,a.Lk)("div",{class:"ps-2 pe-3 ul-status-icon"},[(0,a.Lk)("i",{id:"ul-modal-info-icon",class:"bi bi-file-check"})],-1))),wt={class:"ul-status-description"},St=["innerHTML"],_t={key:0},Dt={class:"text-danger pb-3"},zt={class:"modal-footer"},Et={class:"modal-backdrop",ref:"modalBackdrop",style:{display:"none"}};function $t(e,t,n,o,r,i){const l=(0,a.g2)("DonationInstructions");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",w,[(0,a.Lk)("div",S,[(0,a.Lk)("div",_,[(0,a.Lk)("h4",null,(0,a.v_)(n.name),1)])]),n.instructions.length?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"accordion",id:"ul-acc-"+n.componentId},[(0,a.Lk)("div",z,[(0,a.Lk)("div",E,[$,(0,a.Lk)("div",C,[(0,a.Lk)("h5",null,(0,a.v_)(e.$t("instructions")),1)]),(0,a.Lk)("div",{class:"col accordion-header",id:"acc-instr-head-"+n.componentId},[(0,a.Lk)("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":"#acc-instr-body-"+n.componentId,"aria-expanded":"true","aria-controls":"acc-instr-body-"+n.componentId},null,8,M)],8,I)]),(0,a.Lk)("div",{id:"acc-instr-body-"+n.componentId,class:"accordion-collapse collapse show","aria-labelledby":"headingOne","data-bs-parent":"#ul-acc-"+n.componentId},[(0,a.Lk)("div",T,[(0,a.bF)(l,{instructions:n.instructions,"component-id":n.componentId},null,8,["instructions","component-id"])])],8,F)])],8,D)):(0,a.Q3)("",!0),(0,a.Lk)("div",X,[(0,a.Lk)("div",O,["pending"===r.uploadStatus?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[U,(0,a.Lk)("div",j,[r.uploadAttempts?r.uploadAttempts?((0,a.uX)(),(0,a.CE)("p",A,(0,a.v_)(e.$t("upload-different-file"))+":",1)):(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("h5",P,(0,a.v_)(e.$t("upload-file"))+":",1))]),(0,a.Lk)("div",N,[(0,a.Lk)("label",K,[(0,a.Lk)("input",{name:"ul-"+n.componentId,type:"file",onChange:t[0]||(t[0]=(...e)=>i.processFile&&i.processFile(...e)),class:"d-none"},null,40,B),(0,a.eW)(" "+(0,a.v_)(e.$t("choose-file")),1)])])],64)):"processing"===r.uploadStatus?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[V,(0,a.Lk)("div",R,[(0,a.Lk)("p",null,(0,a.v_)(e.$t("file-is-being-uploaded")),1)]),Q],64)):"success"===r.uploadStatus?((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[H,(0,a.Lk)("div",q,[(0,a.Lk)("p",W,(0,a.v_)(e.$t("upload-success")),1),(0,a.Lk)("p",null,[(0,a.Lk)("a",{onClick:t[1]||(t[1]=e=>r.uploadStatus="pending"),class:"upload-other"},(0,a.v_)(e.$t("choose-different-file")),1)])]),Z],64)):"partial"===r.uploadStatus?((0,a.uX)(),(0,a.CE)(a.FK,{key:3},[J,(0,a.Lk)("div",Y,[(0,a.Lk)("p",G,(0,a.v_)(e.$t("partial-upload-status")),1),(0,a.Lk)("p",null,[(0,a.Lk)("a",{onClick:t[2]||(t[2]=e=>r.uploadStatus="pending"),class:"upload-other"},(0,a.v_)(e.$t("choose-different-file")),1)])]),(0,a.Lk)("div",ee,[(0,a.Lk)("p",null,(0,a.v_)(e.$t("partial-upload-message")),1)])],64)):"failed"===r.uploadStatus?((0,a.uX)(),(0,a.CE)(a.FK,{key:4},[te,(0,a.Lk)("div",ne,[(0,a.Lk)("p",ae,(0,a.v_)(e.$t("upload-failed")),1),(0,a.Lk)("p",null,[(0,a.Lk)("a",{onClick:t[3]||(t[3]=e=>r.uploadStatus="pending"),class:"upload-other"},(0,a.v_)(e.$t("choose-different-file")),1)])]),(0,a.Lk)("div",oe,[(0,a.Lk)("ul",re,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.generalErrors,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e},(0,a.v_)(e),1)))),128))])])],64)):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",ie,[(0,a.Lk)("div",le,[se,(0,a.Lk)("div",de,[(0,a.Lk)("div",ce,[(0,a.Lk)("h5",null,(0,a.v_)(e.$t("data-extraction")),1)]),(0,a.Lk)("div",ue,["pending"===r.uploadStatus?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,a.v_)(e.$t("data-extraction-intro"))+": ",1)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,a.v_)(e.$t("extracted-data-intro"))+": ",1)],64))])])])]),(0,a.Lk)("div",pe,[(0,a.Lk)("div",fe,[(0,a.Lk)("div",he,[(0,a.Lk)("div",me,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.blueprints,(n=>((0,a.uX)(),(0,a.CE)("div",{key:n,class:(0,a.C4)(["ul-status row align-items-start pt-2 pb-2",{"ul-success":"success"===r.blueprintData[n.id.toString()].status,"ul-failed":"failed"===r.blueprintData[n.id.toString()].status}])},["pending"===r.blueprintData[n.id.toString()].status?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[be,(0,a.Lk)("div",ge,[(0,a.Lk)("div",ke,(0,a.v_)(n.name),1),(0,a.Lk)("div",ye,(0,a.v_)(n.description),1)])],64)):(0,a.Q3)("",!0),"success"===r.blueprintData[n.id.toString()].status?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.Lk)("div",ve,[Le,(0,a.Lk)("div",xe,[(0,a.Lk)("div",we,(0,a.v_)(n.name),1),(0,a.Lk)("div",Se,(0,a.v_)(n.description),1)])]),(0,a.Lk)("div",_e,[(0,a.Lk)("div",De,[(0,a.Lk)("div",null,(0,a.v_)(e.$t("extracted-data")),1),(0,a.Lk)("div",ze,[(0,a.Lk)("div",{id:"donation-container-"+n.id.toString(),class:"ul-data-container ul-data-condensed bg-white"},[(0,a.Lk)("div",$e,[(0,a.Lk)("table",{id:"ul-result-"+n.id.toString(),class:"table table-sm"},[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.blueprintData[n.id.toString()].extracted_fields.values(),(e=>((0,a.uX)(),(0,a.CE)("th",{key:e},(0,a.v_)(e),1)))),128))])]),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.blueprintData[n.id.toString()].extracted_data.slice(r.blueprintData[n.id.toString()].fb_pos_lower,r.blueprintData[n.id.toString()].fb_pos_upper),(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.blueprintData[n.id.toString()].extracted_fields.keys(),(t=>((0,a.uX)(),(0,a.CE)(a.FK,{key:t},[t in e?((0,a.uX)(),(0,a.CE)("td",{key:e},(0,a.v_)(e[t]),1)):((0,a.uX)(),(0,a.CE)("td",Ie,"–"))],64)))),128))])))),128))])],8,Ce)]),(0,a.Lk)("div",Me,[(0,a.Lk)("div",Fe,[r.blueprintData[n.id.toString()].fb_pos_lower>14?((0,a.uX)(),(0,a.CE)("a",{key:0,class:"btn btn-secondary btn-sm me-2",onClick:e=>i.updateFbPos(n.id.toString(),"down")},(0,a.v_)(e.$t("previous-page")),9,Te)):(0,a.Q3)("",!0),r.blueprintData[n.id.toString()].fb_pos_lower<=14?((0,a.uX)(),(0,a.CE)("span",Xe,(0,a.v_)(e.$t("previous-page")),1)):(0,a.Q3)("",!0),r.blueprintData[n.id.toString()].fb_pos_upper<r.blueprintData[n.id.toString()].extracted_data.length?((0,a.uX)(),(0,a.CE)("a",{key:2,class:"btn btn-secondary btn-sm",onClick:e=>i.updateFbPos(n.id.toString(),"up")},(0,a.v_)(e.$t("next-page")),9,Oe)):(0,a.Q3)("",!0),r.blueprintData[n.id.toString()].fb_pos_upper>=r.blueprintData[n.id.toString()].extracted_data.length?((0,a.uX)(),(0,a.CE)("span",Ue,(0,a.v_)(e.$t("next-page")),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",je,[(0,a.Lk)("p",Pe,(0,a.v_)(e.$t("extraction-disclaimer",{lower:r.blueprintData[n.id.toString()].fb_pos_lower+1,upper:r.blueprintData[n.id.toString()].fb_pos_upper,total:r.blueprintData[n.id.toString()].extracted_data.length})),1)])])],8,Ee),Ae,(0,a.Lk)("div",{id:"expansion-control-"+n.id.toString(),class:"ul-data-expansion-control control-condensed"},[(0,a.Lk)("a",{class:"text-decoration-none fw-bold",id:"collapse-toggle-"+n.id.toString(),onClick:e=>i.showHideData(n.id.toString())},[(0,a.Lk)("span",{id:"donation-container-"+n.id.toString()+"-toggle-label"},(0,a.v_)(e.$t("show-extracted-data")),9,Be)],8,Ke)],8,Ne)])])]),!1===this.combinedConsent?((0,a.uX)(),(0,a.CE)("div",Ve,[(0,a.Lk)("div",Re,[(0,a.Lk)("p",Qe,(0,a.v_)(e.$t("donation-question")),1),(0,a.Lk)("div",He,[(0,a.Lk)("div",qe,[(0,a.Lk)("label",{class:"form-check-label rb-cb-label",for:"donate-agree-"+n.id.toString()},[(0,a.bo)((0,a.Lk)("input",{type:"radio",id:"donate-agree-"+n.id.toString(),name:"agreement-"+n.id.toString(),value:"true","onUpdate:modelValue":e=>r.blueprintData[n.id.toString()].consent=e,onChange:t[4]||(t[4]=(...e)=>i.emitToParent&&i.emitToParent(...e)),required:""},null,40,Ze),[[a.XL,r.blueprintData[n.id.toString()].consent]]),(0,a.eW)(" "+(0,a.v_)(e.$t("donation-agree")),1)],8,We)]),(0,a.Lk)("div",Je,[(0,a.Lk)("label",{class:"form-check-label rb-cb-label",for:"donate-disagree-"+n.id.toString()},[(0,a.bo)((0,a.Lk)("input",{type:"radio",id:"donate-disagree-"+n.id.toString(),name:"agreement-"+n.id.toString(),value:"false","onUpdate:modelValue":e=>r.blueprintData[n.id.toString()].consent=e,onChange:t[5]||(t[5]=(...e)=>i.emitToParent&&i.emitToParent(...e))},null,40,Ge),[[a.XL,r.blueprintData[n.id.toString()].consent]]),(0,a.eW)(" "+(0,a.v_)(e.$t("donation-disagree")),1)],8,Ye)])])])])):(0,a.Q3)("",!0)],64)):(0,a.Q3)("",!0),"nothing extracted"===r.blueprintData[n.id.toString()].status?((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[et,(0,a.Lk)("div",tt,(0,a.v_)(n.name),1),(0,a.Lk)("div",nt,[r.blueprintData[n.id.toString()].errors.length?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(r.blueprintData[n.id.toString()].errors,(e=>((0,a.uX)(),(0,a.CE)("p",{key:e},(0,a.v_)(e),1)))),128)):((0,a.uX)(),(0,a.CE)("p",at,(0,a.v_)(e.$t("extraction-failed")),1))]),ot,rt],64)):(0,a.Q3)("",!0),"failed"===r.blueprintData[n.id.toString()].status?((0,a.uX)(),(0,a.CE)(a.FK,{key:3},[it,(0,a.Lk)("div",lt,(0,a.v_)(n.name),1),(0,a.Lk)("div",st,[r.blueprintData[n.id.toString()].errors.length?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(r.blueprintData[n.id.toString()].errors,(e=>((0,a.uX)(),(0,a.CE)("p",{key:e},(0,a.v_)(e),1)))),128)):((0,a.uX)(),(0,a.CE)("p",dt,(0,a.v_)(e.$t("extraction-failed")),1))]),ct,ut],64)):(0,a.Q3)("",!0)],2)))),128))])])]),!0!==this.combinedConsent||"success"!==r.uploadStatus&&"partial"!==r.uploadStatus?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",pt,[(0,a.Lk)("div",ft,[(0,a.Lk)("p",ht,(0,a.v_)(e.$t("donation-question")),1),(0,a.Lk)("div",mt,[(0,a.Lk)("div",bt,[(0,a.Lk)("label",gt,[(0,a.bo)((0,a.Lk)("input",{type:"radio",id:"combined-donate-agree",value:"true","onUpdate:modelValue":t[6]||(t[6]=e=>r.combinedDonation=e),onChange:t[7]||(t[7]=(...e)=>i.emitToParent&&i.emitToParent(...e)),required:""},null,544),[[a.XL,r.combinedDonation]]),(0,a.eW)(" "+(0,a.v_)(e.$t("donation-agree")),1)])]),(0,a.Lk)("div",kt,[(0,a.Lk)("label",yt,[(0,a.bo)((0,a.Lk)("input",{type:"radio",id:"combined-donate-disagree",value:"false","onUpdate:modelValue":t[8]||(t[8]=e=>r.combinedDonation=e),onChange:t[9]||(t[9]=(...e)=>i.emitToParent&&i.emitToParent(...e))},null,544),[[a.XL,r.combinedDonation]]),(0,a.eW)(" "+(0,a.v_)(e.$t("donation-disagree")),1)])])])])]))])]),(0,a.Lk)("div",vt,[(0,a.Lk)("div",Lt,[xt,(0,a.Lk)("div",wt,[(0,a.Lk)("h4",null,(0,a.v_)(this.ulModalInfoTitle),1),(0,a.Lk)("p",{id:"ul-modal-info-msg",class:"pb-2",innerHTML:this.ulModalInfoMsg},null,8,St),"failed"===r.uploadStatus?((0,a.uX)(),(0,a.CE)("div",_t,[(0,a.Lk)("ul",Dt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.generalErrors,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e},(0,a.v_)(e),1)))),128))])])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",zt,[(0,a.Lk)("button",{class:"ddm-btn",type:"button",id:"closeUlInfoModal",onClick:t[10]||(t[10]=(...e)=>i.closeUlInfoModal&&i.closeUlInfoModal(...e))},"OK")])],512),(0,a.Lk)("div",Et,null,512)],64)}n(7642),n(8004),n(3853),n(5876),n(2475),n(5024),n(1698),n(3215),n(4520);var Ct=n(1710),It=n.n(Ct);const Mt=e=>((0,a.Qi)("data-v-3ae52e02"),e=e(),(0,a.jt)(),e),Ft=["id"],Tt={key:0,class:"d-flex justify-content-between align-items-center slide-area"},Xt={class:"slide-control-steps-heading"},Ot=["data-bs-target","aria-label","aria-current","onClick"],Ut={class:"slide-control-done-container"},jt={class:"carousel-inner"},Pt=["innerHTML"],At=Mt((()=>(0,a.Lk)("span",{class:"carousel-control-prev-icon","aria-hidden":"true"},null,-1))),Nt=Mt((()=>(0,a.Lk)("span",{class:"visually-hidden"},"Previous",-1))),Kt=[At,Nt],Bt=Mt((()=>(0,a.Lk)("span",{class:"carousel-control-next-icon","aria-hidden":"true"},null,-1))),Vt=Mt((()=>(0,a.Lk)("span",{class:"visually-hidden"},"Next",-1))),Rt=[Bt,Vt];function Qt(e,t,n,o,r,i){return(0,a.uX)(),(0,a.CE)("div",{id:"carousel-"+n.componentId,class:"carousel carousel-dark slide","data-bs-interval":"false","data-bs-ride":"carousel","data-bs-wrap":"false"},[n.instructions.length>1?((0,a.uX)(),(0,a.CE)("div",Tt,[(0,a.Lk)("div",Xt,(0,a.v_)(e.$t("steps")),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.instructions,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:"flex-grow-1 text-center"},[(0,a.Lk)("button",{type:"button","data-bs-target":"#carousel-"+n.componentId,"aria-label":"Step "+t,class:(0,a.C4)([{"active active-item":t<=r.currentStep},"step-indicator d-hide"]),"aria-current":t===r.currentStep,onClick:e=>r.currentStep=t},"•",10,Ot)])))),128)),(0,a.Lk)("div",Ut,[(0,a.Lk)("div",{class:(0,a.C4)(["slide-control-done",{"opacity-0":r.currentStep<n.instructions.length-1}])},"✓",2)])])):(0,a.Q3)("",!0),(0,a.Lk)("div",jt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.instructions,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:(0,a.C4)(["carousel-item",{active:t===r.currentStep}]),innerHTML:e.text},null,10,Pt)))),128))]),(0,a.Lk)("button",{class:(0,a.C4)(["carousel-control-prev",{"d-none":0===r.currentStep}]),type:"button","data-bs-target":"#carousel-0",onClick:t[0]||(t[0]=(...e)=>i.stepDown&&i.stepDown(...e))},Kt,2),(0,a.Lk)("button",{class:(0,a.C4)(["carousel-control-next",{"d-none":r.currentStep===n.instructions.length-1}]),type:"button","data-bs-target":"#carousel-0",onClick:t[1]||(t[1]=(...e)=>i.stepUp&&i.stepUp(...e))},Rt,2)],8,Ft)}var Ht={name:"DonationInstructions",props:{instructions:Array,componentId:Number},data(){return{currentStep:0}},methods:{stepDown(){this.currentStep>0&&(this.currentStep-=1)},stepUp(){this.currentStep<this.instructions.length-1&&(this.currentStep+=1)}}};function qt(e){e.__i18n=e.__i18n||[],e.__i18n.push({locale:"",resource:{en:{steps:e=>{const{normalize:t}=e;return t(["Steps"])}},de:{steps:e=>{const{normalize:t}=e;return t(["Schritte"])}}}})}var Wt=n(6262);"function"===typeof qt&&qt(Ht);const Zt=(0,Wt.A)(Ht,[["render",Qt],["__scopeId","data-v-3ae52e02"]]);var Jt=Zt,Yt=n(7906),Gt=n(4809),en=n.n(Gt),tn=n(6922);function nn(e){return"string"!==typeof e?JSON.stringify(e):e}function an(e){return"number"===typeof e||"string"==typeof e&&(!isNaN(e)&&!isNaN(parseFloat(e)))}function on(e,t){try{return!(!tn.c9.fromISO(e).isValid||!tn.c9.fromISO(t).isValid)||(!(!tn.c9.fromRFC2822(e).isValid||!tn.c9.fromRFC2822(t).isValid)||!(!tn.c9.fromHTTP(e).isValid||!tn.c9.fromHTTP(t).isValid))}catch(n){return!1}}function rn(e,t){return tn.c9.fromISO(e).isValid&&tn.c9.fromISO(t).isValid?[tn.c9.fromISO(e),tn.c9.fromISO(t)]:tn.c9.fromRFC2822(e).isValid&&tn.c9.fromRFC2822(t).isValid?[tn.c9.fromRFC2822(e),tn.c9.fromRFC2822(t)]:tn.c9.fromHTTP(e).isValid&&tn.c9.fromHTTP(t).isValid?[tn.c9.fromHTTP(e),tn.c9.fromHTTP(t)]:[null,null]}function ln(e,t){return an(e)&&an(t)?(e=parseFloat(e),t=parseFloat(t)):on(e,t)?[e,t]=rn(e,t):(e=nn(e),t=nn(t)),[e,t]}function sn(e,t){return e=nn(e),t=nn(t),e===t}function dn(e,t){return e=nn(e),t=nn(t),e!==t}function cn(e,t){return!!(on(e,t)||an(e)&&an(t))&&([e,t]=ln(e,t),e<=t)}function un(e,t){return!!(on(e,t)||an(e)&&an(t))&&([e,t]=ln(e,t),e>=t)}function pn(e,t){return!!(on(e,t)||an(e)&&an(t))&&([e,t]=ln(e,t),e<t)}function fn(e,t){return!!(on(e,t)||an(e)&&an(t))&&([e,t]=ln(e,t),e>t)}function hn(e,t){let n=nn(e),a=RegExp(t,"g");return n.replaceAll(a,"")}function mn(e,t,n){let a=nn(e),o=RegExp(t,"g");return a.replaceAll(o,n)}function bn(e,t){let n=nn(e),a=RegExp(t,"g");return a.test(n)}var gn={name:"ProcessFile",components:{DonationInstructions:Jt},props:{expectsZip:Boolean,blueprints:Array,instructions:Array,componentId:Number,name:String,exceptionUrl:String,combinedConsent:Boolean},emits:["changedData"],data(){return{blueprintData:{},uploadStatus:"pending",uploadAttempts:0,generalErrors:[],ulModalInfoMsg:"",ulModalInfoTitle:"",combinedDonation:null}},created(){this.blueprints.forEach((e=>{let t=e.id,n={name_uploaded_file:null,consent:null,extracted_data:[],extracted_fields:new Map,status:"pending",errors:[],fb_pos_lower:0,fb_pos_upper:15,error_log:{}};this.blueprintData[t.toString()]=n})),this.resetErrorLog(),this.emitToParent()},methods:{processFile(e){let t=this;t.uploadStatus="processing",t.uploadAttempts+=1,t.resetErrorLog();const n=e.target.files;if(t.expectsZip&&1===n.length)It().loadAsync(n[0]).then((e=>{t.blueprints.forEach((n=>{let a=new RegExp(n.regex_path),o=!1;e.file(a).forEach((e=>{o=!0,e.async("string").then((e=>t.processContent(e,n))).catch((e=>{t.postError(4199,e.message),t.recordError(t.$t("error-generic")+e.message,n.id.toString())}))})),o||(t.postError(4180,t.$t("error-regex-not-matched"),n.id),t.postError(4181,`Files in uploaded folder: ${Object.keys(e.files)}`,n.id),t.recordError(t.$t("error-regex-not-matched"),n.id.toString()))}))})).catch((e=>{let n="",a=0;e.message.includes("zip")&&e.message.includes("central")?(n=t.$t("error-not-zip"),a=4101):e.message.includes("Corrupted zip")?(n=t.$t("error-zip-corrupted"),a=4102):e.message.includes("Encrypted zip")?(n=t.$t("error-zip-encrypted"),a=4103):(n=t.$t("error-generic")+e.message,a=4198),t.postError(a,e.message),t.recordError(n,"general")}));else if(t.expectsZip||1!==n.length)t.postError(4104,t.$t("error-multiple-files","en")),t.recordError(t.$t("error-multiple-files"),"general");else{if("json"===t.blueprints[0].format&&!n[0].name.endsWith(".json")){let e=t.$t("error-wrong-file-type","en",{actualType:n[0].name.substr(n[0].name.lastIndexOf(".")),expectedType:".json"});t.postError(4105,e,t.blueprints[0].id),t.recordError(t.$t("error-wrong-file-type",{actualType:n[0].name.substr(n[0].name.lastIndexOf(".")),expectedType:".json"}),t.blueprints[0].id.toString())}if("csv"===t.blueprints[0].format&&!n[0].name.endsWith(".csv")){let e=t.$t("error-wrong-file-type","en",{actualType:n[0].name.substr(n[0].name.lastIndexOf(".")),expectedType:".csv"});t.postError(4105,e,t.blueprints[0].id),t.recordError(t.$t("error-wrong-file-type",{actualType:n[0].name.substr(n[0].name.lastIndexOf(".")),expectedType:".csv"}),t.blueprints[0].id.toString())}let e=new FileReader;e.onload=function(e){let n=e.target.result;try{t.blueprints.forEach((e=>{t.processContent(n,e)}))}catch(a){t.postError(4199,a.message,t.blueprints[0].id),t.recordError(t.$t("error-generic")+a.message,t.blueprints[0].id.toString())}},e.readAsText(n[0])}setTimeout((()=>{t.updateStatus(),t.$nextTick((function(){t.emitToParent()}))}),1e3)},processContent(e,t){let n=this,a=t.id.toString(),o=null,r=[];if("json"===t.format){try{o=JSON.parse(e)}catch(i){n.postError(4106,i.message,t.id),n.recordError(n.$t("error-json-syntax"),n.blueprints[0].id.toString())}o&&(""!==t.json_extraction_root&&(o=this.getNestedJsonEntry(o,t.json_extraction_root)),Symbol.iterator in Object(o)||(o=new Array(o)))}else if("csv"===t.format)try{let n=en().parse(e,{header:!0,delimiter:t.csv_delimiter});o=n.data}catch(i){n.postError(4106,i.message,t.id),n.recordError(n.$t("error-json-syntax"),n.blueprints[0].id.toString())}if(o){let e=0,l=0;if(o.forEach((o=>{let s=[];if(!t.expected_fields.every((n=>{if(t.exp_fields_regex_matching){let t=new RegExp(n);return Object.keys(o).filter((e=>t.test(e))).length>0||(s.push(n),e+=1,!1)}return Object.keys(o).filter((e=>n===e)).length>0||(s.push(n),e+=1,!1)})))return;let d=t.filter_rules,c=new Map;d.forEach((e=>{let a=Object.keys(o);if(e.regex_field){let t=new RegExp(e.field);a=a.filter((e=>t.test(e)))}else{let t=e.field;a=a.filter((e=>t===e))}if(a.length>1){let o=`More than 1 key matches for variable "${e.field}": ${a}; Associated "${a[0]}" to variable.`;n.postError(4203,o,t.id)}else if(0===a.length){let a=`No key matches for variable "${e.field}": ${Object.keys(o)}`;n.postError(4203,a,t.id)}else c.set(e.field,a[0])}));let u={};try{d.length>0&&d.forEach((e=>{let a=c.get(e.field);if("undefined"===a)throw`Field "${a}" not in entry.`;switch(e.comparison_operator){case null:u[e.field]=o[a];break;case"==":if(sn(o[a],e.comparison_value))throw`Field "${a}" matches filter value "${e.comparison_value}" for entry.`;break;case"!=":if(dn(o[a],e.comparison_value))throw`Field "${a}" matches filter value "${e.comparison_value}" for entry.`;break;case"<=":if(cn(o[a],e.comparison_value))throw`Field "${a}" matches filter value "${e.comparison_value}" for entry.`;break;case">=":if(un(o[a],e.comparison_value))throw`Field "${a}" matches filter value "${e.comparison_value}" for entry.`;break;case"<":if(pn(o[a],e.comparison_value))throw`Field "${a}" matches filter value "${e.comparison_value}" for entry.`;break;case">":if(fn(o[a],e.comparison_value))throw`Field "${a}" matches filter value "${e.comparison_value}" for entry.`;break;case"regex-delete-match":if(a in u)try{let t=hn(o[a],e.comparison_value);u[e.field]=t,o[a]=t}catch{let r=`RegexDeleteMatch failed for field ${e.field}.`;n.postError(4220,r,t.id),u[e.field]=o[a]}break;case"regex-replace-match":if(a in u)try{let t=mn(o[a],e.comparison_value,e.replacement_value);u[e.field]=t,o[a]=t}catch{let r=`RegexReplaceMatch failed for field ${e.field}.`;n.postError(4221,r,t.id),u[e.field]=o[a]}break;case"regex-delete-row":if(a in o){let r=!1;try{r=bn(o[a],e.comparison_value)}catch{let a=`RegexDeleteRow failed for field ${e.field}.`;n.postError(4222,a,t.id);break}if(r)throw`Field "${a}" matches RegExp "${e.comparison_value}".`}break;default:break}})),r.push(u)}catch(i){l+=1}for(let[e,t]of c.entries())n.blueprintData[a].extracted_fields.set(e,t)})),n.blueprintData[a].extracted_data=r,r=null,e===o.length){let a=`No data extracted: Expected fields missing in ${e}/${o.length} entries.`;n.postError(4201,a,t.id),n.recordError(n.$t("error-all-expected-fields-missing"),t.id.toString())}else if(l===o.length){let e=`No data extracted: All entries (${l}/${o.length}) were filtered out.`;n.postError(4204,e,t.id),n.recordError(n.$t("error-all-fields-filtered-out"),t.id.toString())}else if(e+l===o.length){let a=`No data extracted: Expected fields missing in ${e}/${o.length} entries and ${l}/${o.length} filtered out.`;n.postError(4205,a,t.id),n.recordError(n.$t("error-all-fields-filtered-out"),t.id.toString())}else if(l>0){let e=`${l}/${o.length} rows omitted due to a filter rule match.`;n.postError(4206,e,t.id)}try{let e=`${n.blueprintData[a].extracted_data.length} entries were extracted.`;n.postError(7004,e,t.id)}catch{}}},getNestedJsonEntry(e,t){t=t.replace(/\[(\w+)\]/g,".$1"),t=t.replace(/^\./,"");let n=t.split(".");for(let a=0,o=n.length;a<o;++a){let t=n[a];if(!(t in e))return;e=e[t]}return e},emitToParent(){let e=JSON.parse(JSON.stringify(this.blueprintData));if(!1===this.combinedConsent)Object.keys(e).forEach((t=>{null===e[t].consent?(e[t].consent=null,e[t].extracted_data=[]):"false"===e[t].consent?(e[t].extracted_data=[],e[t].consent=!1):e[t].consent=!0}));else{let t=this.combinedDonation;Object.keys(e).forEach((n=>{"false"===t?(e[n].consent=!1,e[n].extracted_data=[]):e[n].consent=!0}))}this.$emit("changedData",e)},resetErrorLog(){this.generalErrors=[];for(let e in this.blueprintData)this.blueprintData[e].errors=[]},recordError(e,t){"general"==t?this.generalErrors.push(e):this.blueprintData[t].errors.push(e)},postError(e,t,n=null){if(null!=n){let t=this.blueprintData[n];if(e in t.error_log?t.error_log[e]+=1:t.error_log[e]=1,t.error_log[e]>5)return}let a={status_code:e,message:this.name+": "+t,raised_by:"client",blueprint:n};Yt.A.post(this.exceptionUrl,a).catch((e=>console.error(`Could not post error message, ${e}`)))},updateStatus(){let e=0,t=0,n=Object.keys(this.blueprintData).length;for(let a in this.blueprintData)if(this.blueprintData[a].errors.length){let n=new Set(this.blueprintData[a].errors);1===n.size&&n.has(this.$t("error-all-fields-filtered-out"))?(this.blueprintData[a].status="nothing extracted",this.blueprintData[a].consent="false",t+=1):(this.blueprintData[a].status="failed",this.blueprintData[a].consent="false",e+=1)}else this.blueprintData[a].status="success";this.$nextTick((function(){let a=document.getElementById("ul-modal-info-icon");if(this.generalErrors.length||0!==e||0!==t)if(!this.generalErrors.length&&t>0&&0===e)this.uploadStatus="partial",a.className="bi bi-exclamation-diamond text-orange",this.ulModalInfoTitle=this.$t("ul-nothing-extracted-modal-title"),this.ulModalInfoMsg=this.$t("ul-nothing-extracted-modal-body");else if(!this.generalErrors.length&&e<n)this.uploadStatus="partial",a.className="bi bi-exclamation-diamond text-orange",this.ulModalInfoTitle=this.$t("ul-partial-modal-title"),this.ulModalInfoMsg=this.$t("ul-partial-modal-body");else{this.uploadStatus="failed",a.className="bi bi-x-octagon text-danger",this.ulModalInfoTitle=this.$t("ul-failed-modal-title"),this.ulModalInfoMsg=this.$t("ul-failed-modal-body");for(let e in this.blueprintData)this.blueprintData[e].status="failed"}else this.uploadStatus="success",a.className="bi bi-file-check text-success",this.ulModalInfoTitle=this.$t("ul-success-modal-title"),this.ulModalInfoMsg=this.$t("ul-success-modal-body");this.$refs.ulInfoModal.style.display="block",this.$refs.modalBackdrop.style.display="block"}))},showHideData(e){let t="donation-container-"+e,n=document.getElementById(t),a=document.getElementById(t.concat("-toggle-label")),o=document.getElementById("expansion-control-"+e),r="";n.classList.contains("ul-data-condensed")?(n.classList.replace("ul-data-condensed","ul-data-expanded"),o.classList.replace("control-condensed","control-expanded"),r=this.$t("hide-extracted-data")):(n.classList.replace("ul-data-expanded","ul-data-condensed"),o.classList.replace("control-expanded","control-condensed"),r=this.$t("show-extracted-data")),a.innerHTML=r},closeUlInfoModal(){this.$refs.ulInfoModal.style.display="none",this.$refs.modalBackdrop.style.display="none"},updateFbPos(e,t){let n=this.blueprintData[e];"up"===t?(n.fb_pos_lower+=15,n.fb_pos_upper+=15):n.fb_pos_lower<15?(n.fb_pos_lower=0,n.fb_pos_upper=15):(n.fb_pos_lower-=15,n.fb_pos_upper-=15)}}};function kn(e){e.__i18n=e.__i18n||[],e.__i18n.push({locale:"",resource:{en:{instructions:e=>{const{normalize:t}=e;return t(["Instructions"])},"no-instructions-defined":e=>{const{normalize:t}=e;return t(["No instructions defined"])},"upload-file":e=>{const{normalize:t}=e;return t(["File Upload"])},"data-extraction":e=>{const{normalize:t}=e;return t(["Data Donation"])},"upload-different-file":e=>{const{normalize:t}=e;return t(["Upload a different file"])},"upload-success":e=>{const{normalize:t}=e;return t(["Upload was successful"])},"upload-failed":e=>{const{normalize:t}=e;return t(["Upload failed"])},"choose-different-file":e=>{const{normalize:t}=e;return t(["select a different file"])},"choose-file":e=>{const{normalize:t}=e;return t(["Select File"])},"file-is-being-uploaded":e=>{const{normalize:t}=e;return t(["file is being uploaded"])},"extracted-files":e=>{const{normalize:t}=e;return t(["Extracted files"])},"upload-success-short":e=>{const{normalize:t}=e;return t(["Successfully Uploaded"])},"upload-failed-short":e=>{const{normalize:t}=e;return t(["Upload Failed"])},"show-extracted-data":e=>{const{normalize:t}=e;return t(["Show data"])},"hide-extracted-data":e=>{const{normalize:t}=e;return t(["Show less"])},"donation-question":e=>{const{normalize:t}=e;return t(["Do you agree to donate and submit the data listed above?"])},"donation-agree":e=>{const{normalize:t}=e;return t(["Yes, I agree to submit these data"])},"donation-disagree":e=>{const{normalize:t}=e;return t(["No, I do not want to submit these data"])},"extracted-data-intro":e=>{const{normalize:t}=e;return t(["The following data have been extracted and will be submitted to the researchers with your consent"])},file:e=>{const{normalize:t}=e;return t(["file"])},"error-multiple-files":e=>{const{normalize:t}=e;return t(["More than one file uploaded, but only one is expected."])},"error-not-zip":e=>{const{normalize:t}=e;return t(["A zip-file is expected but another file type was uploaded."])},"error-generic":e=>{const{normalize:t}=e;return t(["An error occurred: "])},"error-zip-corrupted":e=>{const{normalize:t}=e;return t(["The provided zip file is corrupted. Please download the zip file again from the original source and try again."])},"error-zip-encrypted":e=>{const{normalize:t}=e;return t(["The provided zip file is encrypted. Unfortunately, encrypted files are not supported."])},"error-all-expected-fields-missing":e=>{const{normalize:t}=e;return t(["Uploaded file does not contain all expected data fields."])},"error-regex-not-matched":e=>{const{normalize:t}=e;return t(["The provided zip container does not contain the matching file."])},"error-json-syntax":e=>{const{normalize:t}=e;return t(["The provided file contains a syntax error."])},"error-wrong-file-type":e=>{const{normalize:t,interpolate:n,named:a}=e;return t(["The provided file is of type '",n(a("actualType")),"' but '",n(a("expectedType")),"' is expected."])},"error-all-fields-filtered-out":e=>{const{normalize:t}=e;return t(["All entries were filtered out and deleted."])},"extraction-failed":e=>{const{normalize:t}=e;return t(["Information could not be extracted from uploaded file"])},"partial-upload-status":e=>{const{normalize:t}=e;return t(["Only partially uploaded"])},"partial-upload-message":e=>{const{normalize:t}=e;return t(["Zip file was successfully uploaded but not all of the expected information were successfully extracted (see below)"])},"data-extraction-intro":e=>{const{normalize:t}=e;return t(["The following information will be extracted from the selected file"])},"ul-success-modal-title":e=>{const{normalize:t}=e;return t(["Upload Complete"])},"ul-success-modal-body":e=>{const{normalize:t}=e;return t(["All data has been uploaded successfully. Please look at the uploaded data and indicate whether you want to donate the data or not."])},"ul-failed-modal-title":e=>{const{normalize:t}=e;return t(["An Error Occurred"])},"ul-failed-modal-body":e=>{const{normalize:t}=e;return t(["Unfortunately, an error occurred while uploading your file. Please have a look at the error description in the File Upload and Data Donation sections and try again if necessary."])},"ul-partial-modal-title":e=>{const{normalize:t}=e;return t(["Upload Partially Successful"])},"ul-partial-modal-body":e=>{const{normalize:t}=e;return t(["<p>Only parts of the data could be uploaded successfully.</p><p>In the 'Data Donation' section you will find more information on which file a problem occurred. This information may help you to identify and fix the problem.</p><p>If not, you can inspect the uploaded data, indicate whether you want to donate the data or not, and continue.</p>"])},"ul-nothing-extracted-modal-title":e=>{const{normalize:t}=e;return t(["Upload Successful but No Data Extracted"])},"ul-nothing-extracted-modal-body":e=>{const{normalize:t}=e;return t(["<p>The data was successfully uploaded but no data were extracted. It is possible, that your data file did not contain any information relevant to this research project.</p><p>If you think you chose the wrong file, you can try the upload again. Otherwise, you can continue by clicking on 'submit data'.</p>"])},"extracted-data":e=>{const{normalize:t}=e;return t(["If you consent to the donation, the following data will be submitted:"])},"extraction-disclaimer":e=>{const{normalize:t,interpolate:n,named:a}=e;return t(["The rows ",n(a("lower"))," to ",n(a("upper"))," from a total of ",n(a("total"))," extracted data entries are displayed."])},"previous-page":e=>{const{normalize:t}=e;return t(["previous page"])},"next-page":e=>{const{normalize:t}=e;return t(["next page"])}},de:{instructions:e=>{const{normalize:t}=e;return t(["Instruktionen"])},"no-instructions-defined":e=>{const{normalize:t}=e;return t(["Es wurden keine Instruktionen definiert"])},"upload-file":e=>{const{normalize:t}=e;return t(["Datei hochladen"])},"data-extraction":e=>{const{normalize:t}=e;return t(["Datenspende"])},"upload-different-file":e=>{const{normalize:t}=e;return t(["Andere Datei hochladen"])},"upload-success":e=>{const{normalize:t}=e;return t(["Upload erfolgreich abgeschlossen"])},"upload-failed":e=>{const{normalize:t}=e;return t(["Etwas ging schief"])},"choose-different-file":e=>{const{normalize:t}=e;return t(["eine andere Datei auswählen"])},"choose-file":e=>{const{normalize:t}=e;return t(["Datei auswählen"])},"file-is-being-uploaded":e=>{const{normalize:t}=e;return t(["Datei wird hochgeladen"])},"extracted-files":e=>{const{normalize:t}=e;return t(["Ausgelesene Dateien"])},"upload-success-short":e=>{const{normalize:t}=e;return t(["erfolgreich hochgeladen"])},"upload-failed-short":e=>{const{normalize:t}=e;return t(["Upload fehlgeschlagen"])},"show-extracted-data":e=>{const{normalize:t}=e;return t(["Daten anzeigen"])},"hide-extracted-data":e=>{const{normalize:t}=e;return t(["weniger anzeigen"])},"donation-question":e=>{const{normalize:t}=e;return t(["Sind Sie damit einverstanden, diese Daten zu spenden?"])},"donation-agree":e=>{const{normalize:t}=e;return t(["Ja, ich bin damit einverstanden, diese Daten zu spenden und an die Forschenden zu übermitteln."])},"donation-disagree":e=>{const{normalize:t}=e;return t(["Nein, ich möchte diese Daten nicht spenden."])},"extracted-data-intro":e=>{const{normalize:t}=e;return t(["Die folgenden Daten wurden ausgelesen und werden bei Ihrer Zustimmung an die Forschenden übermittelt"])},file:e=>{const{normalize:t}=e;return t(["Datei"])},"error-multiple-files":e=>{const{normalize:t}=e;return t(["Mehr als eine Datei hochgeladen, aber nur eine wird erwartet"])},"error-not-zip":e=>{const{normalize:t}=e;return t(["Es wird eine Zip-Datei erwartet, aber es wurde ein anderer Dateityp hochgeladen."])},"error-generic":e=>{const{normalize:t}=e;return t(["Es ist ein Fehler aufgetreten: "])},"error-zip-corrupted":e=>{const{normalize:t}=e;return t(["Die hochgeladene Zip-Datei scheint beschädigt zu sein. Bitte laden Sie die Zip-Datei erneut von der Originalquelle herunter und versuchen Sie, sie erneut hochzuladen."])},"error-zip-encrypted":e=>{const{normalize:t}=e;return t(["Die hochgeladene Zip-Datei ist password-geschützt. Leider werden verschlüsselte Dateien nicht unterstützt."])},"error-all-expected-fields-missing":e=>{const{normalize:t}=e;return t(["Die hochgeladene Datei enthält nicht alle erwarteten Datenfelder."])},"error-regex-not-matched":e=>{const{normalize:t}=e;return t(["Die entsprechende Datei ist nicht im hochgeladenen Zip-Container enthalten."])},"error-json-syntax":e=>{const{normalize:t}=e;return t(["Die json-Datei enthält einen Syntaxfehler."])},"error-wrong-file-type":e=>{const{normalize:t,interpolate:n,named:a}=e;return t(["Die ausgewählte Datei ist eine '",n(a("actualType")),"'-Datei; es wird aber eine '",n(a("expectedType")),"'-Datei erwartet."])},"error-all-fields-filtered-out":e=>{const{normalize:t}=e;return t(["Alle Einträge in der hochgeladenen Datei wurden herausgefiltert."])},"extraction-failed":e=>{const{normalize:t}=e;return t(["Es konnten nicht alle erwarteten Dateien ausgelesen werden."])},"partial-upload-status":e=>{const{normalize:t}=e;return t(["Nur teilweise hochgeladen"])},"partial-upload-message":e=>{const{normalize:t}=e;return t(["Der Zip-Container wurde erfolgreich hochgeladen, aber es wurden nicht alle Daten erfolgreich extrahiert (siehe unten)"])},"data-extraction-intro":e=>{const{normalize:t}=e;return t(["Die folgenden Informationen werden aus der ausgewählten Datei ausgelesen"])},"ul-success-modal-title":e=>{const{normalize:t}=e;return t(["Upload abgeschlossen"])},"ul-success-modal-body":e=>{const{normalize:t}=e;return t(["Alle Daten wurden erfolgreich hochgeladen. Bitte schauen Sie sich die hochgeladenen Daten an und geben Sie jeweils an, ob Sie die Daten spenden möchten oder nicht."])},"ul-failed-modal-title":e=>{const{normalize:t}=e;return t(["Es ist ein Fehler aufgetreten"])},"ul-failed-modal-body":e=>{const{normalize:t}=e;return t(["Leider ist beim Hochladen ihrer Datei ein Fehler aufgetreten. Bitte schauen Sie sich die Fehlerbeschreibung in den Abschnitten 'Daten hochladen' und 'Datenspende' an und versuchen Sie es gegebenenfalls erneut."])},"ul-partial-modal-title":e=>{const{normalize:t}=e;return t(["Upload teilweise erfolgreich"])},"ul-partial-modal-body":e=>{const{normalize:t}=e;return t(["<p>Es konnte nur ein Teil der Daten erfolgreich hochgeladen werden.</p><p>Im Bereich 'Datenspende' finden Sie weitere Informationen dazu, bei welchen Daten ein Problem aufgetreten ist. Gegebenenfalls helfen Ihnen diese Informationen das Problem zu identifizieren und zu beheben.</p><p>Falls nicht, können Sie sich die erfolgreich hochgeladenen Daten anschauen und entscheiden, ob Sie diese Daten spenden möchten oder nicht.</p>"])},"ul-nothing-extracted-modal-title":e=>{const{normalize:t}=e;return t(["Upload erfolgreich, jedoch wurden keine Daten ausgelesen"])},"ul-nothing-extracted-modal-body":e=>{const{normalize:t}=e;return t(["<p>Die Daten wurden erfolgreich verarbeitet, aber es wurden keine Daten extrahiert. Es ist möglich, dass Ihre Datei keine für dieses Forschungsprojekt relevanten Informationen enthält.</p><p>Wenn Sie denken, dass Sie die falsche Datei ausgewählt haben, können Sie den Upload erneut versuchen.</p><p>Andernfalls können Sie fortfahren, indem Sie auf 'Daten übermitteln' klicken.</p>"])},"extracted-data":e=>{const{normalize:t}=e;return t(["Wenn Sie der Datenspende zustimmen, werden die folgenden Daten übermittelt:"])},"extraction-disclaimer":e=>{const{normalize:t,interpolate:n,named:a}=e;return t(["Es werden die Zeilen ",n(a("lower"))," bis ",n(a("upper"))," von insgesamt ",n(a("total"))," ausgelesenen Einträgen angezeigt."])},"previous-page":e=>{const{normalize:t}=e;return t(["vorherige Seite"])},"next-page":e=>{const{normalize:t}=e;return t(["nächste Seite"])}}}})}"function"===typeof kn&&kn(gn);const yn=(0,Wt.A)(gn,[["render",$t],["__scopeId","data-v-8fc45dd0"]]);var vn=yn,Ln={name:"UApp",components:{FileUploader:vn},props:{uploadConfig:String,actionUrl:String,exceptionUrl:String,language:String},data(){return this.$i18n.locale=this.language,{parsedUploadConfig:JSON.parse(this.uploadConfig),postData:{},locale:this.language,donationStatus:0,infoModalMsg:"undefined"}},watch:{locale(e){this.$i18n.locale=e}},methods:{updatePostData(e){Object.keys(e).forEach((t=>{this.postData[t]=e[t]}))},getStatus(){let e=[],t=[],n=[];Object.keys(this.postData).forEach((a=>{switch(this.postData[a].status){case"success":e.push(this.postData[a]);break;case"failed":t.push(this.postData[a]);break;case"nothing extracted":t.push(this.postData[a]);break;case"pending":n.push(this.postData[a])}})),e.length||t.length||!n.length?!e.length&&n.length&&t.length?this.donationStatus=2:e.length||n.length?e.length&&n.length?this.donationStatus=4:e.length&&!n.length&&t.length?this.donationStatus=5:!e.length||n.length||t.length||(this.donationStatus=6):this.donationStatus=3:this.donationStatus=1},consentValid(){let e=[];return Object.keys(this.postData).forEach((t=>{"pending"!==this.postData[t].status&&e.push(this.postData[t].consent)})),!0!==e.includes(null)||(this.$refs.processingModal.style.display="none",this.infoModalMsg=this.$t("consent-error-msg"),this.$refs.infoModal.style.display="block",!1)},cleanConsent(){Object.keys(this.postData).forEach((e=>{null==this.postData[e].consent&&(this.postData[e].consent=!1)}))},processData(e=!1){if(this.$refs.statusModal.style.display="none",this.$refs.processingModal.style.display="block",this.$refs.modalBackdrop.style.display="block",this.consentValid()){if(!e){if(this.getStatus(),1===this.donationStatus)return this.$refs.processingModal.style.display="none",this.$refs.statusModalMsg.innerHTML=this.$t("status-info-msg-none-attempted"),void(this.$refs.statusModal.style.display="block");if(2===this.donationStatus||4===this.donationStatus)return this.$refs.processingModal.style.display="none",this.$refs.statusModalMsg.innerHTML=this.$t("status-info-msg-not-all-attempted"),void(this.$refs.statusModal.style.display="block")}this.zipData()}},zipData(){this.cleanConsent();let e=document.querySelectorAll("input[type=file]");e.forEach((e=>{e.disabled=!0}));let t=new FormData(document.getElementById("uploader-form")),n=new(It());n.file("ul_data.json",JSON.stringify(this.postData)).generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:5}}).then((e=>{t.append("post_data",e),fetch(this.actionUrl,{method:"POST",body:t}).then((e=>{e.redirected&&(window.location.href=e.url)})).catch((e=>{console.info(e)}))}))},closeInfoModal(){this.$refs.infoModal.style.display="none",this.$refs.modalBackdrop.style.display="none"},closeStatusModal(){this.$refs.statusModal.style.display="none",this.$refs.modalBackdrop.style.display="none"}}};function xn(e){e.__i18n=e.__i18n||[],e.__i18n.push({locale:"",resource:{en:{"data-submit-wait":e=>{const{normalize:t}=e;return t(["Your data donation is being submitted. Please be patient for a moment and do not close this window."])},"next-btn-label":e=>{const{normalize:t}=e;return t(["Submit Data"])},"consent-error-msg":e=>{const{normalize:t}=e;return t(["You did not indicate for all uploads whether you consent to the donation of your data. Please go back and indicate whether you want to donate your data."])},"back-label":e=>{const{normalize:t}=e;return t(["back"])},"cancel-label":e=>{const{normalize:t}=e;return t(["Cancel"])},"continue-anyway-label":e=>{const{normalize:t}=e;return t(["Yes, continue anyway"])},"status-info-msg-not-all-attempted":e=>{const{normalize:t}=e;return t(["You have skipped some data uploads. Are you sure you want to continue?"])},"status-info-msg-none-attempted":e=>{const{normalize:t}=e;return t(["You have not uploaded any data. Are you sure you want to continue?"])}},de:{"data-submit-wait":e=>{const{normalize:t}=e;return t(["Ihre Datenspende wird gerade übermittelt. Bitte haben Sie einen Moment Geduld und schliessen Sie dieses Fenster nicht."])},"next-btn-label":e=>{const{normalize:t}=e;return t(["Daten übermitteln"])},"consent-error-msg":e=>{const{normalize:t}=e;return t(["Sie haben nicht bei allen Uploads angegeben, ob Sie mit der Spende Ihrer Daten einverstanden sind. Bitte gehen Sie zurück und geben Sie an, ob Sie mit der Spende Ihrer Daten einverstanden sind."])},"back-label":e=>{const{normalize:t}=e;return t(["zurück"])},"continue-anyway-label":e=>{const{normalize:t}=e;return t(["Ja, trotzdem fortfahren"])},"cancel-label":e=>{const{normalize:t}=e;return t(["Abbrechen"])},"status-info-msg-not-all-attempted":e=>{const{normalize:t}=e;return t(["Sie haben einige Daten nicht hochgeladen. Sind Sie sicher, dass Sie fortfahren möchten?"])},"status-info-msg-none-attempted":e=>{const{normalize:t}=e;return t(["Sie haben keine Daten hochgeladen. Sind Sie sicher, dass Sie fortfahren möchten?"])}}}})}"function"===typeof xn&&xn(Ln);const wn=(0,Wt.A)(Ln,[["render",L]]);var Sn=wn,_n=n(6992);const Dn=new _n.hU({fallbackLocale:"en"}),zn="#uapp",En=document.querySelector(zn),$n=(0,a.Ef)(Sn,{...En.dataset});$n.use(Dn),$n.mount(zn)}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,r){if(!a){var i=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],r=e[c][2];for(var l=!0,s=0;s<a.length;s++)(!1&r||i>=r)&&Object.keys(n.O).every((function(e){return n.O[e](a[s])}))?a.splice(s--,1):(l=!1,r<i&&(i=r));if(l){e.splice(c--,1);var d=o();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,o,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.j=898}(),function(){var e={898:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,r,i=a[0],l=a[1],s=a[2],d=0;if(i.some((function(t){return 0!==e[t]}))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(s)var c=s(n)}for(t&&t(a);d<i.length;d++)r=i[d],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(c)},a=self["webpackChunkddm_vue_frontend"]=self["webpackChunkddm_vue_frontend"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[504],(function(){return n(6623)}));a=n.O(a)})();
//# sourceMappingURL=vue_uploader.js.map