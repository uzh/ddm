(function(){"use strict";var e={96:function(e,t,n){var o=n(726),a=n(992);const r={key:0,class:"fs-5 fw-bold pb-2"},i={key:1,class:"fw-bold pb-2"},l={class:"btn-group",role:"group","aria-label":"Consent options"},s=["id","name","aria-checked"],c=["for"],u=["id","name","aria-checked"],d=["for"];var p=(0,o.pM)({__name:"ConsentQuestion",props:{combinedConsent:{type:Boolean},blueprintId:{}},emits:["consentUpdated"],setup(e,{emit:t}){const{t:n,te:p,locale:f}=(0,a.s9)(),m=e,g=(0,o.KR)(null),b=t;function v(e){b("consentUpdated",e,m.blueprintId),g.value=e}return(e,t)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[e.combinedConsent?((0,o.uX)(),(0,o.CE)("div",r,(0,o.v_)((0,o.R1)(n)("feedback.donation-question")),1)):((0,o.uX)(),(0,o.CE)("div",i,(0,o.v_)((0,o.R1)(n)("feedback.donation-question")),1)),(0,o.Lk)("div",l,[(0,o.Lk)("input",{type:"radio",class:"btn-check",id:"donate-agree-"+e.blueprintId,name:"agreement-"+e.blueprintId,value:!0,"aria-checked":!0===g.value,autocomplete:"off",onChange:t[0]||(t[0]=e=>v(!0)),required:""},null,40,s),(0,o.Lk)("label",{class:(0,o.C4)([{"selected-donate-agree":!0===g.value},"btn button grey-button donation-btn shadow-none"]),for:"donate-agree-"+e.blueprintId},(0,o.v_)((0,o.R1)(n)("feedback.donation-agree")),11,c),(0,o.Lk)("input",{type:"radio",class:"btn-check",id:"donate-disagree-"+e.blueprintId,name:"agreement-"+e.blueprintId,value:!1,"aria-checked":!1===g.value,autocomplete:"off",onChange:t[1]||(t[1]=e=>v(!1))},null,40,u),(0,o.Lk)("label",{class:(0,o.C4)([{"selected-donate-disagree":!1===g.value},"btn button grey-button donation-btn shadow-none"]),for:"donate-disagree-"+e.blueprintId},(0,o.v_)((0,o.R1)(n)("feedback.donation-disagree")),11,d)])],64))}}),f=n(262);const m=(0,f.A)(p,[["__scopeId","data-v-13ba62d9"]]);var g=m;const b={SUCCESS:"success",PARTIAL:"partial",FAILED:"failed",PENDING:"pending",NO_DATA:"no data extracted"};function v(e,t){let n;return function(...o){n&&clearTimeout(n);const a=this;n=setTimeout((()=>{e.apply(a,o)}),t)}}const h={class:"pb-3"},y={key:0},E={key:0,class:"font-size-875 mb-2 text-end text-md-start pe-2"},x={for:"data-search",class:"visually-hidden"},k=["placeholder"],C={class:"ps-1 pt-1 pe-2"},I={key:0},R={key:1},w={key:2},L={class:"table table-sm mb-0"},_={key:1},S={key:0},N={class:"pb-3 pt-3"},D={key:0,class:"font-size-875 page-controls"},O={key:0,class:"ps-2 pt-2 text-end text-md-start"},T=["disabled"],A=["disabled"],F=20;var P=(0,o.pM)({__name:"ExtractionTable",props:{blueprintOutcome:{}},setup(e){const{t:t,te:n,locale:r}=(0,a.s9)(),i=e,l=(0,o.KR)(1),s=(0,o.rk)("table-container"),c=(0,o.KR)(""),u=(0,o.KR)(""),d=v((e=>{u.value=e.toLowerCase()}),300);(0,o.wB)(c,(e=>{d(e)}));const p=(0,o.EW)((()=>{const e=u.value.toLowerCase();return i.blueprintOutcome.extractedData.filter((t=>{for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const o=t[n];if(String(o).toLowerCase().includes(e))return!0}return!1}))})),f=(0,o.EW)((()=>Math.max(l.value*F-F,0))),m=(0,o.EW)((()=>Math.min(p.value.length,f.value+F))),g=(0,o.EW)((()=>Math.ceil(p.value.length/F)));(0,o.wB)((()=>[g.value]),(()=>{l.value>g.value&&(l.value=g.value),l.value<1&&(l.value=1)}),{immediate:!0,deep:!0});const b=()=>{l.value<g.value&&(l.value+=1,s.value.scrollTop=0)},P=()=>{l.value>1&&(l.value-=1,s.value.scrollTop=0)},U=(0,o.KR)(1===g.value&&m.value<=5);(0,o.wB)((()=>[i.blueprintOutcome.extractedData.length]),(()=>{U.value=1===g.value&&m.value<=5}),{immediate:!0,deep:!0});const X=()=>{U.value=!U.value,s.value.scrollTop=0,s.value.scrollLeft=0};return(e,n)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",h,(0,o.v_)((0,o.R1)(t)("extraction-table.donation-info")),1),i.blueprintOutcome.extractedData.length>1?((0,o.uX)(),(0,o.CE)("div",y,[(0,o.bF)(o.eB,{name:"slide-down"},{default:(0,o.k6)((()=>[U.value?((0,o.uX)(),(0,o.CE)("div",E,[(0,o.Lk)("div",null,[(0,o.Lk)("label",x,(0,o.v_)((0,o.R1)(t)("extraction-table.search-entries")),1),(0,o.bo)((0,o.Lk)("input",{id:"data-search",type:"text","onUpdate:modelValue":n[0]||(n[0]=e=>c.value=e),placeholder:(0,o.R1)(t)("extraction-table.search-entries"),"aria-label":"Search data entries"},null,8,k),[[o.Jo,c.value]])]),(0,o.Lk)("div",C,[p.value.length>0?((0,o.uX)(),(0,o.CE)("span",I,(0,o.v_)((0,o.R1)(t)("extraction-table.entry-info",{lower:f.value+1,upper:m.value,total:p.value.length})),1)):((0,o.uX)(),(0,o.CE)("span",R,(0,o.v_)((0,o.R1)(t)("extraction-table.all-filtered")),1)),p.value.length<i.blueprintOutcome.extractedData.length?((0,o.uX)(),(0,o.CE)("span",w," ("+(0,o.v_)(i.blueprintOutcome.extractedData.length)+" total)",1)):(0,o.Q3)("",!0)])])):(0,o.Q3)("",!0)])),_:1})])):(0,o.Q3)("",!0),(0,o.Lk)("div",null,[(0,o.Lk)("div",{class:(0,o.C4)(["table-wrapper font-size-875",{"table-condensed":!U.value,"table-expanded":U.value}])},[(0,o.Lk)("div",{ref:"table-container",class:(0,o.C4)(["table-container",{"no-scroll":!U.value}])},[(0,o.Lk)("table",L,[(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.blueprintOutcome.extractedFieldsMap.values(),(e=>((0,o.uX)(),(0,o.CE)("th",{key:e},(0,o.v_)(e),1)))),128))])]),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(p.value.slice(f.value,m.value),(t=>((0,o.uX)(),(0,o.CE)("tr",{key:t},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.blueprintOutcome.extractedFieldsMap.keys(),(e=>((0,o.uX)(),(0,o.CE)(o.FK,{key:e},[e in t?((0,o.uX)(),(0,o.CE)("td",{key:t},(0,o.v_)(t[e]),1)):((0,o.uX)(),(0,o.CE)("td",_,"–"))],64)))),128))])))),128)),0===p.value.length?((0,o.uX)(),(0,o.CE)("tr",S,[(0,o.Lk)("td",N,(0,o.v_)((0,o.R1)(t)("extraction-table.all-filtered")),1)])):(0,o.Q3)("",!0)])])],2)],2),g.value>1||1==g.value&&m.value>5?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,o.C4)(["show-data-control text-center font-size-875 mb-3",{"control-expanded":U.value,"control-condensed":!U.value}])},[(0,o.Lk)("button",{class:(0,o.C4)(["button grey-button button-small font-size-small expansion-control-button",{"expansion-control-btn-expanded":U.value,"expansion-control-btn-condensed":!U.value}]),onClick:X},[U.value?U.value?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.Lk)("span",null,(0,o.v_)((0,o.R1)(t)("extraction-table.hide-data")),1),n[2]||(n[2]=(0,o.Lk)("span",{class:"extraction-table-hide-arrow"},[(0,o.Lk)("i",{class:"bi bi-chevron-compact-up"})],-1))],64)):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("span",null,(0,o.v_)((0,o.R1)(t)("extraction-table.show-data")),1),n[1]||(n[1]=(0,o.Lk)("span",{class:"extraction-table-show-arrow"},[(0,o.Lk)("i",{class:"bi bi-chevron-compact-down"})],-1))],64))],2)],2)):(0,o.Q3)("",!0),(0,o.bF)(o.eB,{name:"slide-down"},{default:(0,o.k6)((()=>[U.value?((0,o.uX)(),(0,o.CE)("div",D,[i.blueprintOutcome.extractedData.length>F?((0,o.uX)(),(0,o.CE)("div",O,[(0,o.Lk)("button",{onClick:P,class:"button grey-button button-small me-2",disabled:l.value<=1,"aria-label":"Previous page"},n[3]||(n[3]=[(0,o.Lk)("i",{class:"bi bi-chevron-left"},null,-1)]),8,T),(0,o.Lk)("span",null,(0,o.v_)((0,o.R1)(t)("extraction-table.page"))+" "+(0,o.v_)(l.value)+"/"+(0,o.v_)(Math.max(g.value,1)),1),(0,o.Lk)("button",{onClick:b,class:"button grey-button button-small ms-2",disabled:l.value>=g.value,"aria-label":"Next page"},n[4]||(n[4]=[(0,o.Lk)("i",{class:"bi bi-chevron-right"},null,-1)]),8,A)])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])),_:1})])],64))}});const U=(0,f.A)(P,[["__scopeId","data-v-609de9fc"]]);var X=U;const z={class:"d-flex flex-column align-items-start pt-4 pb-4 blueprint-row"},M={class:"d-flex flex-row align-items-start pb-1"},K={class:"status-icon"},j={class:"fw-bold"},G={class:"d-flex flex-row align-items-start w-100 overflow-hidden"},W={class:"status-icon opacity-0"},B={class:"d-flex flex-column w-100 extraction-item-content"},V={key:0},Q={class:"pb-3"},Z={key:0,class:"pt-4 pb-1"},$={key:2},q={key:0},H={role:"button","aria-expanded":"false",id:"error-details-summary"},J={role:"region","aria-labelledby":"error-details-summary"},Y={key:0,class:"error-details"};var ee=(0,o.pM)({__name:"ExtractionItem",props:{blueprint:{},extractionState:{},extractionMessage:{},extractionErrorText:{},extractionOutcome:{},hasDetailErrors:{type:Boolean},errors:{},combinedConsent:{type:Boolean}},emits:["consentUpdated"],setup(e,{emit:t}){const{t:n,te:r,locale:i}=(0,a.s9)(),l=e,s=t,c={[b.SUCCESS]:"bi bi-file-earmark-check-fill text-success",[b.FAILED]:"bi bi-file-earmark-x-fill text-danger",[b.NO_DATA]:"bi bi-file-earmark-x-fill text-grey",[b.PENDING]:"bi bi-file-earmark-fill text-grey",[b.PARTIAL]:""},u=(0,o.EW)((()=>l.extractionState?c[l.extractionState]:c[b.PENDING])),d=(0,o.EW)((()=>l.extractionState==b.PENDING)),p=(0,o.EW)((()=>l.extractionState==b.SUCCESS)),f=(0,o.EW)((()=>l.extractionState==b.NO_DATA)),m=(0,o.EW)((()=>l.extractionState==b.FAILED)),v=(e,t)=>{s("consentUpdated",e,t)};return(e,t)=>((0,o.uX)(),(0,o.CE)("div",z,[(0,o.Lk)("div",M,[(0,o.Lk)("div",K,[(0,o.Lk)("i",{class:(0,o.C4)(u.value)},null,2)]),(0,o.Lk)("div",j,(0,o.v_)(e.blueprint.name),1)]),(0,o.Lk)("div",G,[(0,o.Lk)("div",W,[(0,o.Lk)("i",{class:(0,o.C4)(u.value)},null,2)]),(0,o.Lk)("div",B,[d.value?((0,o.uX)(),(0,o.CE)("div",V,(0,o.v_)(e.blueprint.description),1)):p.value?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.Lk)("div",Q,(0,o.v_)(e.blueprint.description),1),(0,o.Lk)("div",null,[(0,o.bF)(X,{"blueprint-outcome":e.extractionOutcome},null,8,["blueprint-outcome"])]),!1===e.combinedConsent?((0,o.uX)(),(0,o.CE)("div",Z,[(0,o.bF)(g,{"combined-consent":e.combinedConsent,"blueprint-id":e.blueprint.id,onConsentUpdated:v},null,8,["combined-consent","blueprint-id"])])):(0,o.Q3)("",!0)],64)):f.value?((0,o.uX)(),(0,o.CE)("div",$,(0,o.v_)((0,o.R1)(n)(`${e.extractionMessage}`)),1)):m.value?((0,o.uX)(),(0,o.CE)(o.FK,{key:3},[(0,o.Lk)("div",null,(0,o.v_)((0,o.R1)(n)(`${e.extractionMessage}`))+" "+(0,o.v_)(e.extractionErrorText),1),e.hasDetailErrors?((0,o.uX)(),(0,o.CE)("div",q,[(0,o.Lk)("details",null,[(0,o.Lk)("summary",H,(0,o.v_)((0,o.R1)(n)("feedback.show-error-details")),1),(0,o.Lk)("div",J,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.errors,((e,t)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:t},[(0,o.R1)(r)(`${e.i18nDetail}-detail`)?((0,o.uX)(),(0,o.CE)("p",Y,(0,o.v_)((0,o.R1)(n)(`${e.i18nDetail}-detail`,e.context)),1)):(0,o.Q3)("",!0)],64)))),128))])])])):(0,o.Q3)("",!0)],64)):(0,o.Q3)("",!0)])])]))}});const te=(0,f.A)(ee,[["__scopeId","data-v-7485d948"]]);var ne=te;const oe={class:"pb-3 d-flex align-items-center"},ae={class:"section-heading"};var re=(0,o.pM)({__name:"ExtractionOverview",props:{uploaderState:{},extractionState:{},blueprints:{},blueprintExtractionStates:{},blueprintOutcomeMap:{},combinedConsent:{type:Boolean}},emits:["consentUpdated"],setup(e,{emit:t}){const{t:n,te:r,locale:i}=(0,a.s9)(),l=e,s=t,c=(0,o.Kh)(u());function u(){return Object.fromEntries(l.blueprints.map((e=>{const t=l.blueprintExtractionStates[e.id]?.state,n=l.blueprintExtractionStates[e.id]?.i18nState,o=l.blueprintOutcomeMap[e.id]?.processingErrors??[],a=o.some((e=>r(`${e.i18nDetail}-detail`))),i=p(o);return[e.id,{state:t,msg:n,errors:o,anyDetails:a,errorText:i}]})))}function d(){const e=u();Object.keys(c).forEach((e=>delete c[e])),Object.assign(c,e)}function p(e){let t="";if(0===e.length)return"";if(1===e.length)return n(`${e[0].i18nDetail}`,e[0].context);for(let o=0;o<e.length;o++)t+=n(`${e[o].i18nDetail}`,e[o].context).toLowerCase(),o<e.length-2?t+=", ":o===e.length-2&&(t+=", and ");return t}(0,o.sV)((()=>{d()})),(0,o.wB)((()=>l.uploaderState),(()=>{l.extractionState!=b.PENDING&&d()}),{immediate:!0,deep:!0});const f=(e,t)=>{s("consentUpdated",e,t)},m=(0,o.EW)((()=>l.extractionState===b.PENDING?n("feedback.intro-extraction-pending"):n("feedback.intro-extraction-complete")));return(e,t)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",oe,[t[0]||(t[0]=(0,o.Lk)("span",{class:"section-icon pe-3 pe-sm-0"},[(0,o.Lk)("i",{class:"bi bi-file-earmark-text"})],-1)),(0,o.Lk)("span",ae,(0,o.v_)(m.value),1)]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.blueprints,(t=>((0,o.uX)(),(0,o.Wv)(ne,{key:t.id,blueprint:t,"extraction-state":c[t.id]?.state,"extraction-message":c[t.id]?.msg,"extraction-error-text":c[t.id]?.errorText,"extraction-outcome":e.blueprintOutcomeMap[t.id],"has-detail-errors":c[t.id].anyDetails,errors:c[t.id]?.errors||[],"combined-consent":e.combinedConsent,onConsentUpdated:f},null,8,["blueprint","extraction-state","extraction-message","extraction-error-text","extraction-outcome","has-detail-errors","errors","combined-consent"])))),128))],64))}});const ie=re;var le=ie;const se={IDLE:"idle",PROCESSING:"processing",DONE:"done"},ce={class:"d-lg-flex flex-row align-items-center justify-content-between"},ue={class:"pe-5 pb-3 pb-lg-0 d-flex align-items-center"},de={class:"section-icon"},pe={key:0,class:"bi bi-check-square fs-2 pe-3 text-success"},fe={key:1,class:"bi bi-upload fs-2 pe-3"},me={class:"section-heading"},ge={class:"flex-grow-1"},be={class:"mb-0"},ve={key:0,class:"ps-2 fw-bold fs-6"},he={key:1,class:"ps-2 fw-bold fs-6"},ye=["accept"],Ee={key:1,class:"d-flex align-items-center justify-content-center p-4"},xe={class:"mb-0"},ke={key:2,class:"p-4"},Ce={key:0},Ie={class:"fs-5 fw-bold text-success"},Re={key:1},we={class:"fs-5 fw-bold color-red"},Le={key:0},_e={class:"pt-2"},Se={key:2},Ne={class:"fs-5 fw-bold"},De={key:0,class:"pt-2 w-100 text-center"};var Oe=(0,o.pM)({__name:"FileDrop",props:{expectsZip:{type:Boolean},uploaderState:{},extractionState:{},generalErrors:{}},emits:["fileDropped"],setup(e,{emit:t}){const{t:n,locale:r}=(0,a.s9)(),i=e,l=t,s=(0,o.rk)("fileInput"),c=(0,o.KR)(!1),u=(0,o.KR)(!1),d=(0,o.KR)(""),p=(0,o.lW)(i,"extractionState"),f=(0,o.KR)("bg-lightgrey");(0,o.sV)((()=>{g()}));const m={[b.SUCCESS]:"border-success",[b.PARTIAL]:"border-success",[b.FAILED]:"border-failed",[b.NO_DATA]:"border-no-data",[b.PENDING]:"bg-lightgrey"};function g(){i.expectsZip?d.value=".zip,application/zip,application/x-zip-compressed,multipart/x-zip":d.value="application/json,text/csv,.csv,.json"}function v(e){e.preventDefault(),c.value=!1;const t=e.dataTransfer?.files;t?.[0]&&(u.value=!1,l("fileDropped",t[0]))}function h(e){const t=e.target,n=t.files;if(!n||0===n.length)return;const o=n[0];u.value=!1,l("fileDropped",o)}function y(){u.value=!0,f.value="bg-lightgrey",(0,o.dY)((()=>{s.value?.click()}))}(0,o.wB)(p,(e=>{f.value=m[e]}));const E=(0,o.EW)((()=>i.uploaderState===se.IDLE||u.value)),x=(0,o.EW)((()=>i.uploaderState===se.PROCESSING)),k=(0,o.EW)((()=>i.uploaderState===se.DONE)),C=(0,o.EW)((()=>i.uploaderState===se.DONE&&i.extractionState!==b.FAILED&&!u.value)),I=(0,o.EW)((()=>i.extractionState===b.SUCCESS||i.extractionState===b.PARTIAL)),R=(0,o.EW)((()=>i.extractionState===b.FAILED)),w=(0,o.EW)((()=>i.extractionState===b.NO_DATA));return(e,t)=>((0,o.uX)(),(0,o.CE)("div",ce,[(0,o.Lk)("div",ue,[(0,o.Lk)("span",de,[["success","partial"].includes(i.extractionState)?((0,o.uX)(),(0,o.CE)("i",pe)):((0,o.uX)(),(0,o.CE)("i",fe))]),(0,o.Lk)("span",me,(0,o.v_)((0,o.R1)(n)("file-drop.heading")),1)]),(0,o.Lk)("div",ge,[(0,o.Lk)("div",{class:(0,o.C4)(["border rounded text-center position-relative bg-lightgrey",f.value])},[E.value?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,o.C4)(["p-4",{"dropzone-hover":c.value}]),onDragover:t[0]||(t[0]=(0,o.D$)((e=>c.value=!0),["prevent"])),onDragleave:t[1]||(t[1]=(0,o.D$)((e=>c.value=!1),["prevent"])),onDrop:v,onClick:t[2]||(t[2]=t=>e.$refs.fileInput.click()),style:{cursor:"pointer"}},[(0,o.Lk)("p",be,[t[3]||(t[3]=(0,o.Lk)("i",{id:"ul-modal-info-icon",class:"bi bi-upload fs-5 pe-3"},null,-1)),c.value?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("span",ve,(0,o.v_)((0,o.R1)(n)("file-drop.selection-prompt")),1)),c.value?((0,o.uX)(),(0,o.CE)("span",he,(0,o.v_)((0,o.R1)(n)("file-drop.release-to-select")),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("input",{ref_key:"fileInput",ref:s,type:"file",class:"d-none",accept:d.value,onChange:h},null,40,ye)],34)):x.value?((0,o.uX)(),(0,o.CE)("div",Ee,[t[4]||(t[4]=(0,o.Lk)("span",{class:"spinner-border float-right me-3",role:"status"},[(0,o.Lk)("span",{class:"sr-only"})],-1)),(0,o.Lk)("p",xe,(0,o.v_)((0,o.R1)(n)("file-drop.file-is-being-processed")),1)])):k.value?((0,o.uX)(),(0,o.CE)("div",ke,[I.value?((0,o.uX)(),(0,o.CE)("div",Ce,[(0,o.Lk)("p",Ie,[t[5]||(t[5]=(0,o.Lk)("i",{class:"bi bi-check-circle pe-3"},null,-1)),(0,o.eW)((0,o.v_)((0,o.R1)(n)("file-drop.processing-success")),1)]),(0,o.eW)(" "+(0,o.v_)((0,o.R1)(n)("extraction-state.file.success")),1)])):R.value?((0,o.uX)(),(0,o.CE)("div",Re,[(0,o.Lk)("p",we,(0,o.v_)((0,o.R1)(n)("file-drop.processing-failed")),1),i.generalErrors.length?((0,o.uX)(),(0,o.CE)("div",Le,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.generalErrors,((e,t)=>((0,o.uX)(),(0,o.CE)("p",{key:t,class:"pt-3 color-darkred"},(0,o.v_)((0,o.R1)(n)(e.i18nDetail,e.context)),1)))),128))])):(0,o.Q3)("",!0),(0,o.Lk)("p",_e,[(0,o.eW)((0,o.v_)((0,o.R1)(n)("file-drop.retry-hint"))+" ",1),(0,o.Lk)("button",{class:"button grey-button border border-secondary mt-2",onClick:y},(0,o.v_)((0,o.R1)(n)("file-drop.choose-different-file")),1)])])):w.value?((0,o.uX)(),(0,o.CE)("div",Se,[(0,o.Lk)("p",Ne,(0,o.v_)((0,o.R1)(n)("file-drop.processing-complete")),1),(0,o.eW)(" "+(0,o.v_)((0,o.R1)(n)("extraction-state.file.no-data-extracted")),1)])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)],2),C.value?((0,o.uX)(),(0,o.CE)("div",De,[(0,o.Lk)("button",{class:"button grey-button button-small muted-button font-size-small",onClick:y},(0,o.v_)((0,o.R1)(n)("file-drop.choose-different-file")),1)])):(0,o.Q3)("",!0)])]))}});const Te=(0,f.A)(Oe,[["__scopeId","data-v-3d0d6d16"]]);var Ae=Te;const Fe={class:"d-flex align-items-center",ref:"instruction-heading"},Pe={class:"section-heading"},Ue={class:"d-flex flex-row align-items-center carousel"},Xe={key:0,class:"control-container hidden-small"},ze={class:"carousel-inner"},Me={key:1,class:"control-container hidden-small"},Ke={key:0,class:"text-center d-flex flex-row align-items-center justify-content-center pt-3"},je={key:0,class:"control-container d-flex justify-content-start"},Ge={class:"d-flex flex-wrap flex-row align-items-center justify-content-center"},We=["aria-label","onClick"],Be={key:1,class:"control-container d-flex justify-content-end"};var Ve=(0,o.pM)({__name:"Instructions",props:{instructions:{},componentId:{}},setup(e){const{t:t,locale:n}=(0,a.s9)(),r=e,i=(0,o.rk)("instruction-heading"),l=(0,o.KR)(0);function s(){l.value>0&&(l.value--,i.value.getBoundingClientRect().top<0&&i.value.scrollIntoView())}function c(){l.value<r.instructions.length-1&&(l.value++,i.value.getBoundingClientRect().top<0&&i.value.scrollIntoView())}function u(e){l.value=e,i.value.getBoundingClientRect().top<0&&i.value.scrollIntoView()}const d=(0,o.EW)((()=>l.value>0)),p=(0,o.EW)((()=>l.value<r.instructions.length-1)),f=(0,o.EW)((()=>r.instructions[l.value].text));return(e,n)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",Fe,[n[0]||(n[0]=(0,o.Lk)("span",{class:"section-icon"},[(0,o.Lk)("i",{class:"bi bi-list-ol"})],-1)),(0,o.Lk)("span",Pe,(0,o.v_)((0,o.R1)(t)("instructions.heading")),1)],512),(0,o.Lk)("div",Ue,[r.instructions.length>1?((0,o.uX)(),(0,o.CE)("div",Xe)):(0,o.Q3)("",!0),(0,o.Lk)("div",ze,[(0,o.bF)(o.eB,{name:"fade",mode:"out-in"},{default:(0,o.k6)((()=>[((0,o.uX)(),(0,o.Wv)((0,o.$y)("div"),{key:l.value,class:"carousel-item active",innerHTML:f.value},null,8,["innerHTML"]))])),_:1})]),r.instructions.length>1?((0,o.uX)(),(0,o.CE)("div",Me)):(0,o.Q3)("",!0)]),r.instructions.length>1?((0,o.uX)(),(0,o.CE)("div",Ke,[r.instructions.length>1?((0,o.uX)(),(0,o.CE)("div",je,[d.value?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:s,class:(0,o.C4)(["button grey-button button-small",{"btn-disabled":0===l.value}])},n[1]||(n[1]=[(0,o.Lk)("i",{class:"bi bi-chevron-left"},null,-1),(0,o.Lk)("span",{class:"visually-hidden"},"Previous",-1)]),2)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0),(0,o.Lk)("div",Ge,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.instructions,((e,t)=>((0,o.uX)(),(0,o.CE)("button",{key:t,type:"button",class:(0,o.C4)(["button grey-button button-small m-1",{"active selected-button":t===l.value}]),"aria-label":`Slide ${t+1}`,onClick:e=>u(t)},[(0,o.Lk)("span",null,(0,o.v_)(t+1),1)],10,We)))),128))]),r.instructions.length>1?((0,o.uX)(),(0,o.CE)("div",Be,[p.value?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:c,class:(0,o.C4)(["button grey-button button-small",{"btn-disabled":l.value===r.instructions.length-1}])},n[2]||(n[2]=[(0,o.Lk)("i",{class:"bi bi-chevron-right"},null,-1),(0,o.Lk)("span",{class:"visually-hidden"},"Next",-1)]),2)):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)],64))}});const Qe=(0,f.A)(Ve,[["__scopeId","data-v-126f0998"]]);var Ze=Qe;function $e(e,t){const n=(0,o.KR)(a());function a(){const t={};for(const n of e)t[n.id]=null;return t}const r=(e,o)=>{if(t)for(const t of Object.keys(n.value))n.value[t]=e;else{if(null===o)return void console.warn("Attempted to update consent for null blueprintId in individual consent mode");if(!(o in n.value))return void console.warn(`Attempted to update consent for unknown blueprint ID: ${o}`);n.value[o]=e}};return{blueprintConsentMap:n,updateConsent:r}}const qe={INFO:"info",WARN:"warn",CRITICAL:"critical"},He={FILE:"file",BLUEPRINT:"blueprint"},Je={ZIP_HANDLING:"ZIP handling error",FILE_PROCESSING:"File processing error",BLUEPRINT_SPECIFICATION:"Blueprint specification error",EXTRACTION:"Extraction error"};function Ye(e,t){const n=(0,o.KR)(b.PENDING),a=(0,o.KR)([]),r=(0,o.KR)({});function i(){for(const e of Object.keys(t))r.value[e]={state:b.PENDING,i18nState:null,errorsToDisplay:[]}}function l(){n.value=b.PENDING,a.value=[],r.value={}}function s(){l(),c(),u(),d()}function c(){for(const t of e)t.level===qe.CRITICAL&&a.value.push(t)}function u(){for(const[e,n]of Object.entries(t))r.value[e]=f(n)}function d(){if(a.value.length>0)return void(n.value=b.FAILED);const e=Object.keys(r.value).length,t=m(b.SUCCESS),o=m(b.NO_DATA),i=m(b.FAILED);n.value=p(e,t,o,i)}function p(e,t,n,o){return t===e?b.SUCCESS:n===e?b.NO_DATA:o===e?b.FAILED:b.PARTIAL}function f(e){let t=b.PENDING,n=null;const o=e.processingErrors.filter((e=>e.level===qe.CRITICAL));o.length>0&&(t=b.FAILED,n="extraction-state.blueprint.failed");const a=e.extractedData.length,r=e.extractionStats,i=r.nRowsTotal>0?r.nRowsMissingField/r.nRowsTotal:0,l=r.nRowsTotal>0?r.nRowsFilteredOut/r.nRowsTotal:0;return 0===a&&0===o.length?(t=b.NO_DATA,n=1===i?"extraction-state.blueprint.all-missing-fields":1===l?"extraction-state.blueprint.all-filtered-out":"extraction-state.blueprint.no-data-extracted"):0===o.length&&(t=b.SUCCESS,n="extraction-state.blueprint.success"),{state:t,i18nState:n,errorsToDisplay:o}}function m(e){return Object.values(r.value).filter((t=>t.state===e)).length}return i(),{extractionState:n,generalErrorsToDisplay:a,blueprintExtractionStates:r,getExtractionState:s}}class et{constructor(e){this.blueprintId=e.id,this.extractedData=[],this.extractedFieldsMap=new Map,this.extractionStats={nRowsMissingField:0,nRowsFilteredOut:0,nRowsTotal:0,noKeyMatches:{}},this.extractionRuleLog=this.initializeExtractionRuleLog(e.extraction_rules),this.processingErrors=[]}initializeExtractionRuleLog(e){return Object.fromEntries(e.map((e=>[e.id,0])))}incrementExtractionRuleCount(e){this.extractionStats.nRowsFilteredOut+=1,this.extractionRuleLog[e.id]+=1}registerNoKeyMatch(e,t){this.extractionStats.noKeyMatches[e]||(this.extractionStats.noKeyMatches[e]={});const n=JSON.stringify([...t].sort());this.extractionStats.noKeyMatches[e][n]||(this.extractionStats.noKeyMatches[e][n]=0),this.extractionStats.noKeyMatches[e][n]+=1}registerError(e,t){this.processingErrors.push({type:e.type,category:e.category,scope:e.scope,i18nDetail:e.i18nDetail,level:e.level,context:{...e.context,...t,blueprintId:this.blueprintId}})}mapExtractedField(e,t){this.extractedFieldsMap.has(e)||this.extractedFieldsMap.set(e,t)}}var tt=n(710),nt=n.n(tt);const ot={INVALID_ZIP:{type:"INVALID_ZIP",category:Je.ZIP_HANDLING,scope:He.FILE,i18nDetail:"errors.invalid-zip",level:qe.CRITICAL,context:{fileType:"[invalid file type]"}},ZIP_READ_FAIL:{type:"ZIP_READ_FAIL",category:Je.ZIP_HANDLING,scope:He.FILE,i18nDetail:"errors.zip-read-fail",level:qe.CRITICAL,context:{}},INVALID_REGEX:{type:"INVALID_REGEX",category:Je.BLUEPRINT_SPECIFICATION,scope:He.BLUEPRINT,i18nDetail:"errors.invalid-regex",level:qe.CRITICAL,context:{blueprintId:"[blueprint ID]"}},INVALID_RULE_REGEX:{type:"INVALID_RULE_REGEX",category:Je.EXTRACTION,scope:He.BLUEPRINT,i18nDetail:"errors.invalid-rule-regex",level:qe.WARN,context:{blueprintId:"[blueprint ID]",ruleId:"[rule ID]",ruleRegex:"[rule regex]"}},NO_FILE_MATCH:{type:"NO_FILE_MATCH",category:Je.EXTRACTION,scope:He.BLUEPRINT,i18nDetail:"errors.no-file-match",level:qe.CRITICAL,context:{blueprintId:"[blueprint ID]",regexPath:"[provided regex path]",availableFiles:"[list of files in zip]"}},FILE_PROCESSING_FAIL_GENERAL:{type:"FILE_PROCESSING_FAIL_GENERAL",category:Je.FILE_PROCESSING,scope:He.BLUEPRINT,i18nDetail:"errors.file-processing-fail-general",level:qe.CRITICAL,context:{blueprintId:"[blueprint ID]",error:"[the error that occurred]"}},STRING_CONVERSION_ERROR:{type:"STRING_CONVERSION_ERROR",category:Je.FILE_PROCESSING,scope:He.FILE,i18nDetail:"errors.string-conversion-error",level:qe.CRITICAL,context:{}},NO_EXTRACTION_RULES:{type:"NO_EXTRACTION_RULES",category:Je.BLUEPRINT_SPECIFICATION,scope:He.BLUEPRINT,i18nDetail:"errors.no-extraction-rules",level:qe.CRITICAL,context:{blueprintId:"[blueprint ID]"}},PARSING_ERROR:{type:"PARSING_ERROR",category:Je.FILE_PROCESSING,scope:He.BLUEPRINT,i18nDetail:"errors.parsing-error",level:qe.CRITICAL,context:{blueprintId:"[blueprint ID]",contentType:"[the type of content it tried to parse]"}},UNSUPPORTED_BP_FORMAT:{type:"UNSUPPORTED_BP_FORMAT",category:Je.BLUEPRINT_SPECIFICATION,scope:He.BLUEPRINT,i18nDetail:"errors.unsupported-bp-format",level:qe.CRITICAL,context:{blueprintId:"[blueprint ID]",format:"[name of unsupported format]"}},MORE_THAN_ONE_KEY_MATCH:{type:"MORE_THAN_ONE_KEY_MATCH",category:Je.EXTRACTION,scope:He.BLUEPRINT,i18nDetail:"errors.more-than-one-key-match",level:qe.INFO,context:{blueprintId:"[blueprint ID]",field:"[the field for which multiple matches were found]",keys:"[the keys that were matched]",defaultKey:"[the fallback key used]"}}};function at(e,t,n={}){const o={type:t.type,category:t.category,scope:t.scope,i18nDetail:t.i18nDetail,level:t.level,context:{...t.context,...n}};e.push(o)}var rt=n(809),it=n.n(rt),lt=n(641);function st(e){return"string"!==typeof e?JSON.stringify(e):e}function ct(e){return"number"===typeof e||"string"==typeof e&&(!isNaN(parseFloat(e))&&isFinite(Number(e)))}function ut(e,t){try{return!(!lt.c9.fromISO(e).isValid||!lt.c9.fromISO(t).isValid)||(!(!lt.c9.fromRFC2822(e).isValid||!lt.c9.fromRFC2822(t).isValid)||!(!lt.c9.fromHTTP(e).isValid||!lt.c9.fromHTTP(t).isValid))}catch(n){return console.warn("[bothDates] Error checking date formats:",n),!1}}function dt(e,t){try{if(lt.c9.fromISO(e).isValid&&lt.c9.fromISO(t).isValid)return[lt.c9.fromISO(e),lt.c9.fromISO(t)];if(lt.c9.fromRFC2822(e).isValid&&lt.c9.fromRFC2822(t).isValid)return[lt.c9.fromRFC2822(e),lt.c9.fromRFC2822(t)];if(lt.c9.fromHTTP(e).isValid&&lt.c9.fromHTTP(t).isValid)return[lt.c9.fromHTTP(e),lt.c9.fromHTTP(t)]}catch(n){console.warn(`[getDates] Error parsing dates: ${n}`)}return[null,null]}function pt(e,t){if(ut(e,t)){const[n,o]=dt(e,t);return[n,o]}return ct(e)&&ct(t)?[parseFloat(e),parseFloat(t)]:(e=st(e),t=st(t),[e,t])}function ft(e,t){try{return e=st(e),t=st(t),e===t}catch(n){return console.warn("Error comparing values for equality:",n),!1}}function mt(e,t){try{return e=st(e),t=st(t),e!==t}catch(n){return console.warn("Error comparing values for inequality:",n),!1}}function gt(e,t,n){try{if(ut(e,t)||ct(e)&&ct(t)){const[o,a]=pt(e,t);return null!==o&&null!==a&&n(o,a)}}catch(o){console.warn("Error comparing values:",o)}return!1}function bt(e,t){return gt(e,t,((e,t)=>e<=t))}function vt(e,t){return gt(e,t,((e,t)=>e>=t))}function ht(e,t){return gt(e,t,((e,t)=>e<t))}function yt(e,t){return gt(e,t,((e,t)=>e>t))}function Et(e,t){const n=st(e),o=RegExp(t,"g");return n.replaceAll(o,"")}function xt(e,t,n){const o=st(e),a=RegExp(t,"g");return o.replaceAll(a,n)}function kt(e,t){const n=st(e),o=RegExp(t,"g");return o.test(n)}function Ct(e,t,n){let o=[];for(const a of t){const t=n?Object.keys(e).some((e=>new RegExp(a).test(e))):Object.prototype.hasOwnProperty.call(e,a);t||o.push(a)}return o}function It(e,t,n,o){const a=new Map;for(const r of t){const t=Object.keys(e).filter((e=>{if(r.regex_field)try{return new RegExp(r.field).test(e)}catch(t){return o[n].registerError(ot.INVALID_REGEX,{blueprintId:n,ruleId:r.id,ruleRegex:r.field}),!1}return r.field===e}));if(t.length>1){const e={field:r.field,keys:t,defaultKey:t[0]};o[n].registerError(ot.MORE_THAN_ONE_KEY_MATCH,e),a.set(r.field,t[0]),o[n].mapExtractedField(r.field,t[0])}else 0===t.length?o[n].registerNoKeyMatch(r.field,Object.keys(e)):(a.set(r.field,t[0]),o[n].mapExtractedField(r.field,t[0]))}return a}function Rt(e,t,n,o,a){const r={};for(const i of t){const t=n.get(i.field);if(void 0!==t)switch(i.comparison_operator){case null:r[i.field]=e[t];break;case"==":if(ft(e[t],i.comparison_value))return wt(i,o,a);break;case"!=":if(mt(e[t],i.comparison_value))return wt(i,o,a);break;case"<=":if(bt(e[t],i.comparison_value))return wt(i,o,a);break;case">=":if(vt(e[t],i.comparison_value))return wt(i,o,a);break;case"<":if(ht(e[t],i.comparison_value))return wt(i,o,a);break;case">":if(yt(e[t],i.comparison_value))return wt(i,o,a);break;case"regex-delete-match":if(t in r)try{let n=Et(e[t],i.comparison_value);r[i.field]=n,e[t]=n,a[o].extractionRuleLog[i.id]+=1}catch{r[i.field]=e[t]}break;case"regex-replace-match":if(t in r)try{let n=xt(e[t],i.comparison_value,i.replacement_value);r[i.field]=n,e[t]=n,a[o].extractionRuleLog[i.id]+=1}catch{r[i.field]=e[t]}break;case"regex-delete-row":if(t in e){let n=!1;try{n=kt(e[t],i.comparison_value)}catch{break}if(n)return wt(i,o,a)}break;default:break}}Object.keys(r).length>0&&a[o].extractedData.push(r)}function wt(e,t,n){n[t].incrementExtractionRuleCount(e)}function Lt(e,t,n){if(0===t.extraction_rules.length)return void n[t.id].registerError(ot.NO_EXTRACTION_RULES,{});const o=_t(e,t,n);if(o){n[t.id].extractionStats.nRowsTotal=o.length;for(const e of o){if(null==e)continue;const o=Ct(e,t.expected_fields,t.exp_fields_regex_matching);if(o.length>0){n[t.id].extractionStats.nRowsMissingField+=1;continue}const a=It(e,t.extraction_rules,t.id,n);Rt(e,t.extraction_rules,a,t.id,n)}}else n[t.id].registerError(ot.PARSING_ERROR,{contentType:""})}function _t(e,t,n){let o=null;if("json"===t.format)try{o=St(e,t.json_extraction_root)}catch(a){n[t.id].registerError(ot.PARSING_ERROR,{contentType:"JSON",error:a})}else{if("csv"!==t.format)return n[t.id].registerError(ot.UNSUPPORTED_BP_FORMAT,{format:t.format}),null;try{o=Nt(e,t.csv_delimiter)}catch(a){n[t.id].registerError(ot.PARSING_ERROR,{contentType:"CSV",error:a})}}return o||(n[t.id].registerError(ot.PARSING_ERROR,{contentType:t.format}),null)}function St(e,t){let n;try{n=JSON.parse(e)}catch(o){throw new Error(`Failed to parse JSON content: ${o}`)}if(t&&""!==t)try{n=Dt(n,t)}catch(o){throw new Error(`Failed to get nested JSON content: ${o}`)}return Symbol.iterator in Object(n)||(n=new Array(n)),n}function Nt(e,t){try{const n=it().parse(e,{header:!0,delimiter:t,skipEmptyLines:!0,dynamicTyping:!1});if(n.errors.length>0)throw new Error(`CSV parsing errors: ${n.errors}`);return n.data}catch(n){throw new Error(`An error occurred during csv parsing: ${n}`)}}function Dt(e,t){if("object"!==typeof e||null==e)return;const n=t.replace(/\[(\w+)]/g,".$1").replace(/^\./,"").split(".");let o=e;for(const a of n){if(null==o||!(a in o))return;o=o[a]}return o}async function Ot(e,t,n,o){if(!At(e)){const t=e.name.slice(e.name.lastIndexOf(".")+1);return void at(o,ot.INVALID_ZIP,{fileType:t})}let a;try{a=await nt().loadAsync(e)}catch(r){return void at(o,ot.ZIP_READ_FAIL,{error:r})}for(const i of t){let e;try{e=new RegExp(i.regex_path)}catch(r){n[i.id].registerError(ot.INVALID_REGEX,{error:r});continue}const t=a.file(e);if(0!==t.length)for(const o of t)try{const e=await o.async("string");Lt(e,i,n)}catch(r){n[i.id].registerError(ot.FILE_PROCESSING_FAIL_GENERAL,{error:r})}else{const e=Object.keys(a.files),t={regexPath:i.regex_path,availableFiles:e};n[i.id].registerError(ot.NO_FILE_MATCH,t)}}}function Tt(e,t,n,o){return new Promise(((a,r)=>{const i=new FileReader;i.onload=function(e){const i=e.target.result;if("string"!==typeof i)return at(o,ot.STRING_CONVERSION_ERROR,{}),r("invalid content");t.forEach((e=>{try{Lt(i,e,n)}catch(t){n[e.id].registerError(ot.FILE_PROCESSING_FAIL_GENERAL,{error:t})}})),a()},i.onerror=function(e){const t=e.target?.error||new Error("Unknown file reading error");at(o,ot.FILE_PROCESSING_FAIL_GENERAL,{error:t}),r(t)},i.readAsText(e)}))}function At(e){const t=e.name.toLowerCase().endsWith(".zip"),n=["application/zip","application/x-zip-compressed","multipart/x-zip"].includes(e.type);return t&&n}function Ft(e,t){const n=(0,o.Kh)([]),a=(0,o.Kh)({});function r(){n.length=0,Object.keys(a).forEach((e=>{delete a[e]}));for(const e of t)a[e.id]=new et(e)}function i(){r()}async function l(o){r();try{await new Promise((e=>setTimeout(e,1e3))),e?await Ot(o,t,a,n):await Tt(o,t,a,n)}catch(i){console.error("Unexpected error during file processing:",i)}}return i(),{generalErrors:n,blueprintOutcomeMap:a,handleSelectedFile:l}}function Pt(e,t){const{t:n}=(0,a.s9)({locale:"en"});let r=(0,o.KR)(Date.now());async function i(e,t){r.value=Date.now();for(const o of e)await l(null,o.type,n(o.i18nDetail,o.context));for(const o of Object.values(t)){for(const t of o.processingErrors)"NO_FILE_MATCH"===t.type?await l(o.blueprintId,t.type,n(`${t.i18nDetail}-detail`,t.context)):await l(o.blueprintId,t.type,n(t.i18nDetail,t.context));const e={EXTRACTION_STATS:o.extractionStats,EXTRACTION_LOG:o.extractionRuleLog,EXTRACTED_FIELDS_MAP:o.extractedFieldsMap};for(const[t,n]of Object.entries(e))await l(o.blueprintId,t,JSON.stringify(n))}}async function l(n,o,a){const i={status_code:o,message:a,raised_by:"client",uploader:e,blueprint:n,date:new Date(r.value).toISOString()};try{const e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});return!!e.ok||(console.error(`Error posting log: ${e.status} ${e.statusText}`),!1)}catch(l){return console.error("Could not post error message:",l),!1}}return{postLogs:i}}const Ut={class:"uploader-name"},Xt={class:"uploader-container"},zt={key:0,class:"uploader-section"},Mt={class:"uploader-section"},Kt={class:"uploader-section"},jt={key:1,class:"uploader-section"};var Gt=(0,o.pM)({__name:"UploaderWrapper",props:{blueprintConfigs:{},combinedConsent:{type:Boolean},componentId:{},exceptionUrl:{},expectsZip:{type:Boolean},instructionConfig:{},name:{}},emits:["statusChanged"],setup(e,{emit:t}){const{t:n,locale:r}=(0,a.s9)(),i=e,l=t;let s=(0,o.KR)(se.IDLE);const{generalErrors:c,blueprintOutcomeMap:u,handleSelectedFile:d}=Ft(i.expectsZip,i.blueprintConfigs),{postLogs:p}=Pt(i.componentId,i.exceptionUrl);async function f(e){s.value=se.PROCESSING,await d(e),y(),k(),p(c,u).catch((e=>{console.error("Logs could not be posted to backend:",e)})),s.value=se.DONE}const{extractionState:m,generalErrorsToDisplay:v,blueprintExtractionStates:h,getExtractionState:y}=Ye(c,u),{blueprintConsentMap:E,updateConsent:x}=$e(i.blueprintConfigs,i.combinedConsent);function k(){l("statusChanged",i.componentId,E.value,m.value,h.value,u)}(0,o.wB)(E,(()=>{k()}),{deep:!0}),(0,o.sV)((()=>{k()}));const C=(0,o.EW)((()=>m.value===b.SUCCESS||m.value===b.PARTIAL)),I=(0,o.EW)((()=>!0===i.combinedConsent&&C.value));return(e,t)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",Ut,(0,o.v_)(e.name),1),(0,o.Lk)("div",Xt,[e.instructionConfig.length>0?((0,o.uX)(),(0,o.CE)("div",zt,[(0,o.bF)(Ze,{instructions:e.instructionConfig,"component-id":e.componentId},null,8,["instructions","component-id"])])):(0,o.Q3)("",!0),(0,o.Lk)("div",Mt,[(0,o.bF)(Ae,{"expects-zip":i.expectsZip,"uploader-state":(0,o.R1)(s),"extraction-state":(0,o.R1)(m),"general-errors":(0,o.R1)(v),onFileDropped:f},null,8,["expects-zip","uploader-state","extraction-state","general-errors"])]),(0,o.Lk)("div",Kt,[(0,o.bF)(le,{"uploader-state":(0,o.R1)(s),"extraction-state":(0,o.R1)(m),blueprints:i.blueprintConfigs,"blueprint-extraction-states":(0,o.R1)(h),"blueprint-outcome-map":(0,o.R1)(u),"combined-consent":e.combinedConsent,onConsentUpdated:(0,o.R1)(x)},null,8,["uploader-state","extraction-state","blueprints","blueprint-extraction-states","blueprint-outcome-map","combined-consent","onConsentUpdated"])]),I.value?((0,o.uX)(),(0,o.CE)("div",jt,[(0,o.bF)(g,{"combined-consent":e.combinedConsent,"blueprint-id":null,onConsentUpdated:(0,o.R1)(x)},null,8,["combined-consent","onConsentUpdated"])])):(0,o.Q3)("",!0)])],64))}});const Wt=(0,f.A)(Gt,[["__scopeId","data-v-1c001274"]]);var Bt=Wt;const Vt={class:"modal-container"},Qt={class:"issue-modal",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",tabindex:"-1"},Zt={class:"modal-body pt-4 pt-md-5"},$t={id:"modal-title",class:"visually-hidden"},qt={class:"modal-text"},Ht={key:0,class:"m-0"},Jt={key:1,class:"m-0"},Yt={key:2,class:"m-0"},en={key:3,class:"m-0"},tn={class:"modal-footer"};var nn=(0,o.pM)({__name:"IssueModal",props:{failedUploaderNames:{},unattendedUploaderShare:{},unattendedUploaderNames:{},blueprintsWithoutConsentCount:{},blueprintsWithoutConsentNames:{},allUploadersValid:{type:[Boolean,null]},showModal:{type:Boolean}},emits:["continueAnyway","modalClosed"],setup(e,{emit:t}){const{t:n,locale:r}=(0,a.s9)(),i=e,l=t,s=(0,o.KR)(!1),c=(0,o.EW)((()=>0===i.blueprintsWithoutConsentCount));(0,o.wB)((()=>i.showModal),(()=>{s.value=i.showModal,!0===s.value&&document.body.classList.add("modal-open")}),{immediate:!0});const u=()=>{s.value=!1,l("modalClosed"),document.body.classList.remove("modal-open")},d=e=>{const t=e.length;if(0===t)return"";let n="";for(let o=0;o<t;o++)n+='"'+e[o]+'"',(o<t-2||o===t-2)&&(n+=", ");return n};function p(e){"Escape"===e.key&&u()}return(0,o.sV)((()=>{window.addEventListener("keydown",p)})),(0,o.hi)((()=>{window.removeEventListener("keydown",p)})),(e,t)=>s.value?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("div",{class:"modal-backdrop",onClick:u}),(0,o.Lk)("div",Vt,[(0,o.Lk)("div",Qt,[(0,o.Lk)("div",Zt,[(0,o.Lk)("h2",$t,(0,o.v_)((0,o.R1)(n)("issue-modal.title")),1),t[1]||(t[1]=(0,o.Lk)("div",{class:"pb-2 pb-md-0 ps-md-2 pe-md-3 text-center"},[(0,o.Lk)("i",{class:"bi bi-info-circle-fill fs-1"})],-1)),(0,o.Lk)("div",qt,[1===e.unattendedUploaderShare?((0,o.uX)(),(0,o.CE)("p",Ht,(0,o.v_)((0,o.R1)(n)("issue-modal.none-attempted")),1)):e.blueprintsWithoutConsentCount>0&&e.unattendedUploaderShare<1?((0,o.uX)(),(0,o.CE)("p",Jt,(0,o.v_)((0,o.R1)(n)("issue-modal.not-all-consented",{"blueprints-wo-consent":d(i.blueprintsWithoutConsentNames)})),1)):e.unattendedUploaderShare>0?((0,o.uX)(),(0,o.CE)("p",Yt,(0,o.v_)((0,o.R1)(n)("issue-modal.not-all-attempted",{"skipped-uploads":d(i.unattendedUploaderNames)})),1)):e.failedUploaderNames.length>0?((0,o.uX)(),(0,o.CE)("p",en,(0,o.v_)((0,o.R1)(n)("issue-modal.failed-uploaders",{uploads:d(i.failedUploaderNames)})),1)):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",tn,[(0,o.Lk)("button",{type:"button",class:"button black-button",onClick:u},(0,o.v_)((0,o.R1)(n)("issue-modal.back")),1),c.value?((0,o.uX)(),(0,o.CE)("button",{key:0,type:"button",class:"button grey-button",onClick:t[0]||(t[0]=e=>{u(),l("continueAnyway")})},(0,o.v_)((0,o.R1)(n)("issue-modal.continue-anyway")),1)):(0,o.Q3)("",!0)])])])],64)):(0,o.Q3)("",!0)}});const on=(0,f.A)(nn,[["__scopeId","data-v-f5dbf91e"]]);var an=on;function rn(e){const t=(0,o.KR)([]),n=(0,o.KR)([]),a=(0,o.KR)([]),r=(0,o.KR)(0),i=(0,o.KR)(null),l=(0,o.EW)((()=>{const t=Object.keys(e.value).length;if(0===t)return 0;const o=n.value.length;return o/t}));function s(){const e=c(),t=d(),n=u();return e&&t&&n?(i.value=!0,!0):(i.value=!1,!1)}const c=()=>{n.value=[];for(const t of Object.values(e.value))t.uploaderState===b.PENDING&&n.value.push(t.uploaderName);return 0===n.value.length},u=()=>{a.value=[],r.value=0;for(const t of Object.values(e.value))if(t.consentMap)for(const e of Object.keys(t.consentMap))null===t.consentMap[e]&&t.blueprintStates[e].state===b.SUCCESS&&(a.value.push(t.blueprintNames[e]),r.value+=1);else console.log(`Uploader ${t.uploaderName} is missing consentMap.`);return 0===a.value.length},d=()=>{t.value=[];for(const n of Object.values(e.value))console.log(`Uploader ${n.uploaderName}.`),console.log(`State ${n.uploaderState}.`),console.log(`State ${n.uploaderName}.`),n.uploaderState===b.FAILED&&t.value.push(n.uploaderName);return 0===t.value.length};return{validateUploaders:s,failedUploaderNames:t,unattendedUploaderShare:l,unattendedUploaderNames:n,blueprintsWithoutConsentCount:r,blueprintsWithoutConsentNames:a,allUploadersValid:i}}function ln(e,t){const n=(0,o.KR)(!1);function a(){const t={};for(const n of Object.values(e.value))if(n.extractionOutcome)for(const e of Object.values(n.extractionOutcome)){let o=[];!0===n.consentMap[e.blueprintId]&&(o=e.extractedData),t[e.blueprintId]={consent:n.consentMap[e.blueprintId],extractedData:o,status:n.blueprintStates[e.blueprintId].state}}return t}async function r(e,t){const n=new(nt());return n.file(t,JSON.stringify(e)),await n.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:5}})}async function i(){n.value=!0;const e=a();if(0===Object.keys(e).length)return console.warn("No data to submit"),!1;const o=await r(e,"data_donation.json"),i=document.getElementById("uploader-form");if(!i)return console.error("Form element not found"),!1;const l=new FormData(i);l.append("post_data",o);try{const e=await fetch(t,{method:"POST",body:l});return e.redirected&&(window.location.href=e.url),!0}catch(s){console.error("Error during data submission to server:",s)}finally{n.value=!1}}return{submitting:n,submitDonation:i}}const sn={class:"custom-modal",id:"processingModal",role:"dialog","aria-modal":"true","aria-labelledby":"loading-message","aria-live":"assertive"},cn={class:"modal-dialog modal-dialog-centered custom-modal-container m-0"},un={class:"modal-content fs-1 text-center custom-modal-content"},dn={id:"loading-message",class:"p-3 modal-message"};var pn=(0,o.pM)({__name:"SubmittingOverlay",setup(e){const{t:t,locale:n}=(0,a.s9)();return(e,n)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",sn,[(0,o.Lk)("div",cn,[(0,o.Lk)("div",un,[(0,o.Lk)("div",dn,(0,o.v_)((0,o.R1)(t)("submitting-modal.submit-wait")),1),n[0]||(n[0]=(0,o.Lk)("div",{class:"dot-floating","aria-hidden":"true"},null,-1))])])]),n[1]||(n[1]=(0,o.Lk)("div",{class:"modal-backdrop"},null,-1))],64))}});const fn=(0,f.A)(pn,[["__scopeId","data-v-2fab3ad3"]]);var mn=fn;const gn={class:"ddm-uploader mb-5"},bn={class:"row"},vn={class:"col"},hn={id:"uploader-form",method:"POST",enctype:"multipart/form-data"},yn=["value"];var En=(0,o.pM)({__name:"UploaderApp",props:{uploaderConfigs:{},actionUrl:{},exceptionUrl:{},language:{},csrfToken:{}},setup(e){const{t:t,locale:n}=(0,a.s9)(),r=e,i=(0,o.KR)(x()),{validateUploaders:l,failedUploaderNames:s,unattendedUploaderShare:c,unattendedUploaderNames:u,blueprintsWithoutConsentCount:d,blueprintsWithoutConsentNames:p,allUploadersValid:f}=rn(i),{submitting:m,submitDonation:g}=ln(i,r.actionUrl);function b(e,t,n,o,a){const r=i.value[e];r&&Object.assign(r,{consentMap:t,uploaderState:n,blueprintStates:o,extractionOutcome:a})}let v=(0,o.KR)(!1);function h(){v.value=!1}function y(){l(),f.value?g():v.value=!0}function E(e){const t={};for(const n of e.blueprints)t[n.id]=n.name;return t}function x(){const e={};for(const t of r.uploaderConfigs)e[t.uploader_id]={uploaderName:t.name,blueprintNames:E(t),consentMap:null,uploaderState:null,blueprintStates:null,extractionOutcome:null};return e}return(e,n)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.uploaderConfigs,(e=>((0,o.uX)(),(0,o.CE)("div",gn,[(0,o.bF)(Bt,{"blueprint-configs":e.blueprints,"combined-consent":e.combined_consent,componentId:e.uploader_id,"exception-url":r.exceptionUrl,"expects-zip":"zip file"===e.upload_type,"instruction-config":e.instructions,name:e.name,onStatusChanged:b},null,8,["blueprint-configs","combined-consent","componentId","exception-url","expects-zip","instruction-config","name"])])))),256)),(0,o.bF)(an,{"failed-uploader-names":(0,o.R1)(s),"unattended-uploader-share":(0,o.R1)(c),"unattended-uploader-names":(0,o.R1)(u),"blueprints-without-consent-count":(0,o.R1)(d),"blueprints-without-consent-names":(0,o.R1)(p),"all-uploaders-valid":(0,o.R1)(f),"show-modal":(0,o.R1)(v),onContinueAnyway:(0,o.R1)(g),onModalClosed:h},null,8,["failed-uploader-names","unattended-uploader-share","unattended-uploader-names","blueprints-without-consent-count","blueprints-without-consent-names","all-uploaders-valid","show-modal","onContinueAnyway"]),(0,o.R1)(m)?((0,o.uX)(),(0,o.Wv)(mn,{key:0})):(0,o.Q3)("",!0),(0,o.Lk)("div",bn,[(0,o.Lk)("div",vn,[(0,o.Lk)("button",{class:"flow-btn",type:"button",onClick:y},(0,o.v_)((0,o.R1)(t)("uploader-app.next-btn"))+"  ›",1)])]),(0,o.bo)((0,o.Lk)("form",hn,[(0,o.Lk)("input",{type:"hidden",name:"csrfmiddlewaretoken",value:e.csrfToken},null,8,yn)],512),[[o.aG,!1]])],64))}});const xn=En;var kn=xn,Cn=JSON.parse('{"instructions":{"heading":"How it works"},"errors":{"invalid-zip":"A ZIP-file was expected but a {fileType}-file was uploaded.","zip-read-fail":"Failed to read ZIP archive","invalid-regex":"Invalid regex","invalid-rule-regex":"The field name \'{ruleRegex}\' of extraction rule {ruleId} could not be parsed as regex.","no-file-match":"The selected ZIP-container did not contain the correct file.","no-file-match-detail":"We tried to identify the file using the following pattern: \\n \'{regexPath}\' \\n \\n Available files in the container: \\n {availableFiles}","file-processing-fail-general":"An error occurred during processing the file content.","file-processing-fail-general-detail":"The following error occurred: {error}","string-conversion-error":"File content cannot be converted to string","no-extraction-rules":"No extraction rules defined.","parsing-error":"Failed to parse {contentType} content for this file.","unsupported-bp-format":"Unsupported content format: {format}","more-than-one-key-match":"More than one key match for field \'{field}\': {keys}. Defaulted to {defaultKey}","no-key-match":"No key match for field \'{field}\': {keys}","undefined-key":"Undefined key for field \'{field}\'"},"file-drop":{"heading":"Select file","selection-prompt":"Click to select a file from your device","release-to-select":"Drop the file to continue","file-is-being-processed":"Processing your file...","processing-complete":"Processing complete","processing-success":"File successfully processed","processing-failed":"The file could not be successfully processed","choose-different-file":"select a different file","retry-hint":"The file may not contain the right information. See below for more details or try again by selecting a different file:"},"extraction-state":{"file":{"success":"Below you can see which data were extracted.","no-data-extracted":"No information could be extracted from the file."},"blueprint":{"success":"Your data has been successfully extracted","no-data-extracted":"No relevant data found in the file.","all-missing-fields":"Required information was missing from all entries in the file.","all-filtered-out":"All entries in the file were excluded based on the filtering criteria.","failed":"Data could not be extracted due to the following issue(s):"}},"feedback":{"intro-extraction-pending":"Data to be extracted","intro-extraction-complete":"Extracted data","show-error-details":"Show details","donation-question":"Do you agree to donate and submit the data listed above?","donation-agree":"Yes","donation-disagree":"No"},"extraction-table":{"entry-info":"Entries {lower}-{upper} of {total}","donation-info":"If you consent to the donation, the following data will be submitted:","search-entries":"Search entries...","all-filtered":"No entries found","show-data":"Show all data","hide-data":"Show less","page":"Page"},"uploader-app":{"next-btn":"Next"},"issue-modal":{"title":"Data donation not complete","none-attempted":"You have not uploaded any files. \\n \\n Continue without a donation?","not-all-attempted":"Some uploads were skipped: {skipped-uploads}. Continue with the files processed so far?","not-all-consented":"For some extracted data, it was not indicated whether these may be transmitted: {blueprints-wo-consent}. \\n \\n Please go back to review.","failed-uploaders":"The following uploads appear to have failed: {uploads}. \\n \\n Continue anyway?","continue-anyway":"Yes, continue anyway","back":"Go back"},"submitting-modal":{"submit-wait":"Processing your data donation..."}}'),In=JSON.parse('{"instructions":{"heading":"So funktioniert es"},"errors":{"invalid-zip":"Eine ZIP-Datei wurde erwartet, aber eine {fileType}-Datei wurde hochgeladen.","zip-read-fail":"ZIP-Archiv konnte nicht gelesen werden","invalid-regex":"Ungültiger regulärer Ausdruck (regex)","invalid-rule-regex":"Der Feldname \'{ruleRegex}\' der Extraction Rule {ruleId} konnte nicht korrekt in eine RegEx umgewandelt werden.","no-file-match":"Diese Datei konnte im ausgewählten ZIP-Container nicht gefunden werden.","no-file-match-detail":"Keine Datei konnte mit dem folgenden Muster identifiziert werden: \\n \'{regexPath}\' \\n \\n Verfügbare Dateien im ZIP-Container: \\n {availableFiles}","file-processing-fail-general":"Beim Verarbeiten des Datei-Inhalts ist ein Fehler aufgetreten","file-processing-fail-general-detail":"Der folgende Fehler trat auf: {error}","string-conversion-error":"Dateiinhalt kann nicht in einen Text (String) umgewandelt werden","no-extraction-rules":"Es wurden keine Extraktionsregeln definiert","parsing-error":"Es trat ein Fehler beim Parsen von {contentType}-Inhalt für diese Datei auf","unsupported-bp-format":"Nicht unterstütztes Dateiformat: {format}","more-than-one-key-match":"Mehr als eine Übereinstimmung für Feld \'{field}\': {keys}. Es wurde standardmäßig \'{defaultKey}\' verwendet","no-key-match":"Keine Übereinstimmung für Feld \'{field}\': {keys}","undefined-key":"Undefinierter Name für Feld \'{field}\'"},"file-drop":{"heading":"Datei auswählen","selection-prompt":"Hier klicken um eine Datei auszuwählen","release-to-select":"Loslassen, um Datei auszuwählen","file-is-being-processed":"Datei wird verarbeitet…","processing-complete":"Verarbeitung abgeschlossen","processing-success":"Datei erfolgreich verarbeitet","processing-failed":"Datei konnte nicht verarbeitet werden","choose-different-file":"eine andere Datei auswählen","retry-hint":"Die ausgewählte Datei enthält möglicherweise nicht die benötigten Informationen (siehe unten für weitere Details). Eine andere Datei auswählen, um es erneut zu versuchen:"},"extraction-state":{"file":{"success":"Unten werden die ausgelesenen Daten angezeigt.","no-data-extracted":"Es konnten keine Informationen aus der Datei ausgelesen werden."},"blueprint":{"success":"Daten erfolgreich ausgelesen.","no-data-extracted":"Keine relevanten Daten in der Datei gefunden.","all-missing-fields":"Alle Einträge in der Datei sind unvollständig und können nicht ausgelesen werden.","all-filtered-out":"Alle Einträge wurden aufgrund der gewählten Filter-Kriterien ausgeschlossen.","failed":"Es konnten keine Daten ausgelesen werden, aufgrund von folgenden Problemen:"}},"feedback":{"intro-extraction-pending":"Die folgenden Daten werden ausgelesen","intro-extraction-complete":"Ausgelesene Daten","show-error-details":"Details anzeigen","donation-question":"Sind Sie damit einverstanden, diese Daten zu spenden und zu übermitteln?","donation-agree":"Ja","donation-disagree":"Nein"},"extraction-table":{"entry-info":"Einträge {lower}-{upper} von {total} werden angezeigt","donation-info":"Wenn Sie der Datenspende zustimmen, werden die folgenden Daten übermittelt:","search-entries":"Einträge durchsuchen...","all-filtered":"Keine Einträge gefunden","show-data":"alle Daten anzeigen","hide-data":"weniger anzeigen","page":"Seite"},"uploader-app":{"next-btn":"Weiter"},"issue-modal":{"title":"Datenspende wurde nicht abgeschlossen","none-attempted":"Es wurden keine Dateien hochgeladen. \\n \\n Ohne Datenspende fortfahren?","not-all-attempted":"Einige Uploads wurden übersprungen: {skipped-uploads}.  \\n \\n Mit den bisher verarbeiteten Dateien fortfahren?","not-all-consented":"Es muss für alle ausgelesenen Daten angegeben werden, ob diese übermittelt werden dürfen. \\n \\n Für die folgenden Daten fehlt diese Information noch: {blueprints-wo-consent}.","failed-uploaders":"Die folgenden Uploads scheinen nicht funktioniert zu haben: {uploads}. \\n \\n Trotzdem fortfahren?","continue-anyway":"Trotzdem fortfahren","back":"Zurück"},"submitting-modal":{"submit-wait":"Die Datenspende wird verarbeitet..."}}'),Rn=JSON.parse('{"instructions":{"heading":"Come funziona"},"errors":{"invalid-zip":"Era atteso un file ZIP, ma è stato caricato un file {fileType}.","zip-read-fail":"Impossibile leggere l\'archivio ZIP","invalid-regex":"Espressione regolare (regex) non valida","invalid-rule-regex":"Il nome del campo \'{ruleRegex}\' della regola di estrazione {ruleId} non è stato convertito correttamente in regex.","no-file-match":"Questo file non è stato trovato nel contenitore ZIP selezionato.","no-file-match-detail":"Nessun file è stato identificato con il seguente modello: \\n \'{regexPath}\' \\n \\n File disponibili nel contenitore ZIP: \\n {availableFiles}","file-processing-fail-general":"Si è verificato un errore durante l\'elaborazione del contenuto del file","file-processing-fail-general-detail":"Si è verificato il seguente errore: {error}","string-conversion-error":"Il contenuto del file non può essere convertito in testo (string)","no-extraction-rules":"Non sono state definite regole di estrazione","parsing-error":"Si è verificato un errore durante il parsing del contenuto {contentType} di questo file","unsupported-bp-format":"Formato file non supportato: {format}","more-than-one-key-match":"Più di una corrispondenza per il campo \'{field}\': {keys}. È stato utilizzato \'{defaultKey}\' per impostazione predefinita","no-key-match":"Nessuna corrispondenza per il campo \'{field}\': {keys}","undefined-key":"Nome non definito per il campo \'{field}\'"},"file-drop":{"heading":"Seleziona file","selection-prompt":"Clicca qui per selezionare un file","release-to-select":"Rilascia per selezionare il file","file-is-being-processed":"Elaborazione del file in corso…","processing-complete":"Elaborazione completata","processing-success":"File elaborato con successo","processing-failed":"Il file non ha potuto essere elaborato","choose-different-file":"Seleziona un file diverso","retry-hint":"Il file selezionato potrebbe non contenere le informazioni necessarie (vedi sotto per ulteriori dettagli). Seleziona un file diverso per riprovare:"},"extraction-state":{"file":{"success":"Di seguito vengono visualizzati i dati estratti.","no-data-extracted":"Non è stato possibile estrarre informazioni dal file."},"blueprint":{"success":"Dati estratti con successo.","no-data-extracted":"Nessun dato rilevante trovato nel file.","all-missing-fields":"Tutti i record nel file sono incompleti e non possono essere estratti.","all-filtered-out":"Tutti i record sono stati esclusi in base ai criteri di filtro selezionati.","failed":"Non è stato possibile estrarre i dati a causa dei seguenti errori:"}},"feedback":{"intro-extraction-pending":"I seguenti dati verranno estratti","intro-extraction-complete":"Dati estratti","show-error-details":"Mostra dettagli","donation-question":"Acconsente a donare e trasmettere questi dati?","donation-agree":"Sì","donation-disagree":"No"},"extraction-table":{"entry-info":"Visualizzazione dei record {lower}-{upper} su {total}","donation-info":"Se acconsente alla donazione dei dati, verranno trasmessi i seguenti dati:","search-entries":"Cerca record...","all-filtered":"Nessun record trovato","show-data":"mostra tutti i dati","hide-data":"mostra meno","page":"Pagina"},"uploader-app":{"next-btn":"Avanti"},"issue-modal":{"title":"Donazione dei dati non completata","none-attempted":"Non è stato caricato alcun file. \\n \\n Continuare senza donazione dei dati?","not-all-attempted":"Alcuni caricamenti sono stati saltati: {skipped-uploads}. \\n \\n Continuare con i file elaborati finora?","not-all-consented":"Per alcuni dati non è stato indicato se possono essere trasmessi: {blueprints-wo-consent}. \\n \\n La preghiamo di verificare.","failed-uploaders":"I seguenti caricamenti sembrano non aver funzionato: {uploads}. \\n \\n Continuare comunque?","continue-anyway":"Continua comunque","back":"Indietro"},"submitting-modal":{"submit-wait":"Elaborazione della donazione dei dati in corso..."}}'),wn=JSON.parse('{"instructions":{"heading":"Comment ça fonctionne"},"errors":{"invalid-zip":"Un fichier ZIP était attendu, mais un fichier {fileType} a été téléchargé.","zip-read-fail":"Impossible de lire l\'archive ZIP","invalid-regex":"Expression régulière (regex) non valide","invalid-rule-regex":"Le nom de champ \'{ruleRegex}\' de la règle d\'extraction {ruleId} n\'a pas pu être correctement converti en regex.","no-file-match":"Ce fichier n\'a pas pu être trouvé dans le fichier ZIP sélectionné.","no-file-match-detail":"Aucun fichier ne correspond au modèle suivant : \\n « {regexPath} » \\n \\n Fichiers disponibles dans le ZIP : \\n {availableFiles}","file-processing-fail-general":"Une erreur s\'est produite lors du traitement du contenu du fichier","file-processing-fail-general-detail":"L\'erreur suivante s\'est produite : {error}","string-conversion-error":"Le contenu du fichier ne peut pas être converti en texte (string)","no-extraction-rules":"Aucune règle d\'extraction n\'a été définie","parsing-error":"Une erreur s\'est produite lors de l’analyse du contenu {contentType} de ce fichier","unsupported-bp-format":"Format de fichier non pris en charge : {format}","more-than-one-key-match":"Plus d\'une correspondance pour le champ \'{field}\' : {keys}. \'{defaultKey}\' a été utilisé par défaut","no-key-match":"Aucune correspondance pour le champ \'{field}\' : {keys}","undefined-key":"Nom non défini pour le champ \'{field}\'"},"file-drop":{"heading":"Sélectionner un fichier","selection-prompt":"Cliquez ici pour sélectionner un fichier","release-to-select":"Relâchez pour sélectionner le fichier","file-is-being-processed":"Traitement du fichier en cours…","processing-complete":"Traitement terminé","processing-success":"Fichier traité avec succès","processing-failed":"Le fichier n\'a pas pu être traité","choose-different-file":"sélectionner un autre fichier","retry-hint":"Le fichier sélectionné ne contient peut-être pas les informations nécessaires (voir ci-dessous pour plus de détails). Sélectionnez un autre fichier pour réessayer :"},"extraction-state":{"file":{"success":"Les données extraites sont affichées ci-dessous.","no-data-extracted":"Aucune information n\'a pu être extraite du fichier."},"blueprint":{"success":"Données extraites avec succès.","no-data-extracted":"Aucune donnée pertinente trouvée dans le fichier.","all-missing-fields":"Toutes les entrées du fichier sont incomplètes et ne peuvent pas être extraites.","all-filtered-out":"Toutes les entrées ont été exclues en raison des critères de filtrage sélectionnés.","failed":"Les données n\'ont pas pu être extraites en raison des erreurs suivantes :"}},"feedback":{"intro-extraction-pending":"Les données suivantes seront extraites","intro-extraction-complete":"Données extraites","show-error-details":"Afficher les détails","donation-question":"Acceptez-vous de faire don de ces données et de les transmettre ?","donation-agree":"Oui","donation-disagree":"Non"},"extraction-table":{"entry-info":"Affichage des entrées {lower}-{upper} sur {total}","donation-info":"Si vous consentez au don de données, les données suivantes seront transmises :","search-entries":"Rechercher des entrées...","all-filtered":"Aucune entrée trouvée","show-data":"afficher toutes les données","hide-data":"afficher moins","page":"Page"},"uploader-app":{"next-btn":"Suivant"},"issue-modal":{"title":"Le don de données n’a pas été finalisé","none-attempted":"Aucun fichier n\'a été téléchargé. \\n \\n Continuer sans don de données ?","not-all-attempted":"Certains téléchargements ont été ignorés : {skipped-uploads}. \\n \\n Continuer avec les fichiers traités jusqu\'à présent ?","not-all-consented":"Pour certaines données, il n\'a pas été indiqué si elles peuvent être transmises : {blueprints-wo-consent}. \\n \\n Veuillez vérifier.","failed-uploaders":"Les téléchargements suivants semblent avoir échoué : {uploads}. \\n \\n Continuer quand même ?","continue-anyway":"Continuer quand même","back":"Retour"},"submitting-modal":{"submit-wait":"Traitement du don de données en cours..."}}');function Ln(e,t){const n={...e};for(const o in t)t[o]&&"object"===typeof t[o]&&!Array.isArray(t[o])?n[o]=Ln(n[o]||{},t[o]):n[o]=t[o];return n}function _n(){const e={selector:"#uapp",defaultLocale:"en",fallbackLocale:"en"},t=document.querySelector(e.selector);if(!t)throw console.error(`Mount element not found using selector: "${e.selector}"`),new Error(`Failed to initialize uploader: Mount element "${e.selector}" not found`);const n=["actionUrl","csrfToken","uploaderConfigsAsString","exceptionUrl"];for(const o of n){const e=o.charAt(0).toLowerCase()+o.slice(1);if(!t.dataset[e])throw new Error(`Required attribute data-${o.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))} is missing`)}const r=t.dataset.uploaderConfigsAsString;let i=[];try{i=JSON.parse(r??"[]")}catch(p){console.error("Failed to parse uploadConfig:",p)}const l=(0,o.Ef)(kn,{actionUrl:t.dataset.actionUrl,exceptionUrl:t.dataset.exceptionUrl,language:t.dataset.language,uploaderConfigs:i,csrfToken:t.dataset.csrfToken});let s={en:Cn,de:In,it:Rn,fr:wn};if(t.dataset.customTranslations){const e=JSON.parse(t.dataset.customTranslations||"{}");null!=e&&""!=e&&(s={en:Ln(Cn,e.en||{}),de:Ln(In,e.de||{}),it:Ln(Rn,e.it||{}),fr:Ln(wn,e.fr||{})})}const c=(0,a.hU)({legacy:!1,locale:e.defaultLocale,fallbackLocale:e.fallbackLocale,messages:s}),u=t.dataset.language||e.defaultLocale,d=c.global.availableLocales;d.includes(u)?c.global.locale.value=u:c.global.locale.value=e.fallbackLocale,l.use(c),l.mount(e.selector)}_n()}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,a,r){if(!o){var i=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],r=e[u][2];for(var l=!0,s=0;s<o.length;s++)(!1&r||i>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[s])}))?o.splice(s--,1):(l=!1,r<i&&(i=r));if(l){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[o,a,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={256:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,r,i=o[0],l=o[1],s=o[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(s)var u=s(n)}for(t&&t(o);c<i.length;c++)r=i[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},o=self["webpackChunkddm_uploader_frontend"]=self["webpackChunkddm_uploader_frontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(96)}));o=n.O(o)})();
//# sourceMappingURL=ddm_uploader_frontend.js.map