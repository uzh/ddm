<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: DDM Documentation</title>
    <meta name="generator" content="Antora 3.1.9">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
    <link rel="icon" href="../../../_/img/ddl_favicon_black.svg" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <div>
        <a class="navbar-item" href="../../.."><img src="../../../_/img/DDM_Logo_Schwarz.svg" height="50px"></a>
      </div>
      <div class="navbar-slogan">
        <a class="navbar-item" href="../../..">Data Donation Module Documentation</a>
      </div>
      <!--
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
      -->
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ddm" data-version="v1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <!-- 
    <h3 class="title"><a href="../index.html">DDM</a></h3>
     -->
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-link-1" href="../for_researchers.html">For Researchers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-link-1" href="../for_admins.html">For System Administrators</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-link-1" href="../for_developers.html">For Developers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-link-1" href="../topic_references.html">Topic References</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link nav-link-1" href="../issues.html">Reporting Issues and Getting Help</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">DDM</span>
    <span class="version">v1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../main/index.html">DDM</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../main/index.html">main</a>
        </li>
        <li class="version">
          <a href="../../develop/index.html">develop</a>
        </li>
        <li class="version">
          <a href="../../v1.0.19/index.html">v1.0.19</a>
        </li>
        <li class="version is-current">
          <a href="../index.html">v1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<!--
-->
<!-- <nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
 -->
<!-- <div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">v1.0.0</button>
  <div class="version-menu">
    <a class="version" href="../../main/topics/encryption.html">main</a>
    <a class="version" href="../../develop/topics/encryption.html">develop</a>
    <a class="version" href="../../v1.0.19/topics/encryption.html">v1.0.19</a>
    <a class="version is-current" href="encryption.html">v1.0.0</a>
  </div>
</div>
 -->
<!--
-->
</div>
  <div class="content">
<aside class="toc sidebar" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
  <nav class="breadcrumbs-article" aria-label="breadcrumbs">
</nav>
  <div class="paragraph">
<p>This pages aims to describe what types of encryption should be used by the system hosting this module and what is implemented in this module.</p>
</div>
<div class="sect2">
<h3 id="_encryption_in_transit_and_at_rest"><a class="anchor" href="#_encryption_in_transit_and_at_rest"></a>Encryption in transit and at rest</h3>
<div class="sect3">
<h4 id="_encryption_in_transit"><a class="anchor" href="#_encryption_in_transit"></a>Encryption in transit</h4>
<div class="paragraph">
<p>It is site-level responsibility to setup encryption in transit, like SSL/TLS for all communication between clients and the server.
For some hints on how this should be setup, start with the <a href="https://docs.djangoproject.com/en/4.0/topics/security/#ssl-https&gt;">Django docs</a>.
We minimize the amount of potential data that is processed on the server, by doing most of the filtering client-side.
Do take into account that ideally the connection from system to the database is secured as well, and that the database is stored on an encrypted system.</p>
</div>
</div>
<div class="sect3">
<h4 id="_encryption_at_rest"><a class="anchor" href="#_encryption_at_rest"></a>Encryption at rest</h4>
<div class="paragraph">
<p>The module stores all data in encrypted fields in the database, the encryption/decryption procedure is described below.
Each project has a unique <code>salt</code> that is generated when creating the project.
In the Django site settings, we use the <strong>SECRET_KEY</strong> as the default passphrase for encryption.
If a project is working with sensitive data, we recommend that a <strong>project specific password</strong> is set.
This password is only known by the person setting it and should not be shared.
A project specific password will limit the functionality of the module for a given project: it won&#8217;t be possible to create followup questions based on the data donation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_encryption_and_decryption_process"><a class="anchor" href="#_encryption_and_decryption_process"></a>Encryption and decryption process</h3>
<div class="sect3">
<h4 id="_steps"><a class="anchor" href="#_steps"></a>Steps</h4>
<div class="paragraph">
<p>We use a hybrid asymmetric/symmetric encryption approach, due to the size limitation of the pure asymmetric approach.
The following steps occur in the encryption process
- generate a public key and store it in the project (if none exists)
- generate a session key used for encrypting a single message
- encrypt the data symmetrically using the session key
- encrypt the session key using the public key asymmetrically
- store the encrypted data with the encrypted key as header</p>
</div>
<div class="paragraph">
<p>The following steps occur in the decryption process
- generate a private key
- get the desired encrypted data from the project
- decrypt the encrypted session key (header) asymmetrically using the private key
- decrypt the data using the decrypted session key symmetrically</p>
</div>
</div>
<div class="sect3">
<h4 id="_asymmetric_key_generation_and_process"><a class="anchor" href="#_asymmetric_key_generation_and_process"></a>Asymmetric Key Generation and process</h4>
<div class="paragraph">
<p>For encryption we only need the public key;
- Check if we have a public key that is saved for the project
- if not, we should have gotten a passphrase and a salt with which we can generate a public key.&#8201;&#8212;&#8201;generate the private key&#8201;&#8212;&#8201;derive the public key&#8201;&#8212;&#8201;save the public key for the project
- We then use <a href="https://tools.ietf.org/html/rfc8017">PKCS#1 OAEP</a> for the wrapping and OAEP padding.</p>
</div>
<div class="paragraph">
<p>For decryption we need the private key;
- Using the supplied passphrase and salt, we generate a 128bit <a href="https://en.wikipedia.org/wiki/HMAC">HMAC</a> digest, which we use to populate a pseudo-random number generator.
- This random number generator is used to generate our <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">RSA</a> key.
- We then use <a href="https://tools.ietf.org/html/rfc8017">PKCS#1 OAEP</a> for wrapping the OAEP padding.</p>
</div>
</div>
<div class="sect3">
<h4 id="_symmetric_key_generation_and_process"><a class="anchor" href="#_symmetric_key_generation_and_process"></a>Symmetric Key Generation and process</h4>
<div class="paragraph">
<p>There are significant limitations on the size of the data that can be encrypted using asymmetric algorithms and severe performance penalties.
This is why we combine this with symmetric encryption.
In our case we use <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard&gt;">AES</a> to encrypt the actual data.</p>
</div>
</div>
</div>
  </article>
  </div>
</main>
<div id="overlay"></div>
</div>
<footer class="footer">
  <div class="footer-content-bite"><a href="https://datadonation.uzh.ch"><img src="../../../_/img/DataDonationLab_Logo_Schwarz.svg" height="50px"></a></div>
  <div class="footer-content-bite">Â© Data Donation Lab, 2023-present</div>
  <div class="footer-content-bite"><a href="https://github.com/uzh/ddm">DDM on GitHub</a></div>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
